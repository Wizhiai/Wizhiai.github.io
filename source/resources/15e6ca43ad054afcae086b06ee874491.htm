<!doctype html>
<html lang="zh" data-hairline="true" class="itcauecng" data-theme="light"><head><meta charSet="utf-8"/><title data-rh="true">mysql 优化方法有哪些？ - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/><meta name="renderer" content="webkit"/><meta name="force-rendering" content="webkit"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"/><meta data-rh="true" name="description" property="og:description" content="面试官如果问你：你会从哪些维度进行MySQL性能优化？你会怎么回答？所谓的性能优化，一般针对的是MySQL查…"/><meta data-rh="true" name="keywords" content="数据库,面试,MySQL,MySQL 入门,MySQL DBA"/><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png"/><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png" sizes="152x152"/><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.d5793cac.png" sizes="120x120"/><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.7abf3393.png" sizes="76x76"/><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.362a8eac.png" sizes="60x60"/><link crossorigin="" rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/heifetz/favicon.ico"/><link crossorigin="" rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/heifetz/search.xml" title="知乎"/><link rel="dns-prefetch" href="//static.zhimg.com"/><link rel="dns-prefetch" href="//pica.zhimg.com"/><link rel="dns-prefetch" href="//picx.zhimg.com"/><link rel="dns-prefetch" href="//pic1.zhimg.com"/><link rel="dns-prefetch" href="//pic2.zhimg.com"/><link rel="dns-prefetch" href="//pic3.zhimg.com"/><link rel="dns-prefetch" href="//pic4.zhimg.com"/><link rel="dns-prefetch" href="//static.zhihu.com"/><script nonce="94c77dd1-58fc-430b-95c9-a87e9f3e934c" data-web-reporter-config="{&quot;platform&quot;:&quot;web&quot;,&quot;project&quot;:&quot;heifetz&quot;}">!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).webReporter={})}(this,function(e){"use strict";var t={},n=!1,o=function(){var e,o,r,a,i;return n||(e=document.querySelector("script[data-web-reporter-config]"),o=e&&e.dataset.webReporterConfig||"{}",r=JSON.parse(o),a=r.platform,i=r.project,t={platform:a,project:i},n=!0),t};function r(e){return a(function(){return localStorage.getItem(e)})()}function a(e){return function(){try{return e.apply(void 0,arguments)}catch(e){}}}var i=a(function(e,t){var n={platform:"web",project:o().project,clientTimestamp:+new Date};!function(e,t,n){"1"===r("weber:logenabled")&&console.log("[web-reporter]%o",{type:e,base:t,data:n})}(e,n,t),function(e,t){var n=btoa(JSON.stringify(t));if("undefined"!=typeof Blob&&window.navigator&&window.navigator.sendBeacon){var o=new Blob([n],{type:"text/plain"});navigator.sendBeacon(e,o)}else{var r=new XMLHttpRequest;r.open("POST",e),r.withCredentials=!1,r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),r.send(n)}}(r("weber:api")||"https://apm.zhihu.com/collector/web_json",{type:e,base:n,data:t})});e.report=i,Object.defineProperty(e,"__esModule",{value:!0})});
</script><link href="https://static.zhihu.com/heifetz/765.216a26f4.97d4b18fec6f1112aa3c.css" crossorigin="" rel="stylesheet"/><link href="https://static.zhihu.com/heifetz/main.216a26f4.636280215996da924864.css" crossorigin="" rel="stylesheet"/><link href="https://static.zhihu.com/heifetz/7359.216a26f4.4fdad2c8e502ded22ea6.css" crossorigin="" rel="stylesheet"/><link href="https://static.zhihu.com/heifetz/4213.216a26f4.4a9340ff00edf241ec88.css" crossorigin="" rel="stylesheet"/><link href="https://static.zhihu.com/heifetz/main-question-routes.216a26f4.76cd58bb46c08ca4ab3c.css" crossorigin="" rel="stylesheet"/><script nonce="94c77dd1-58fc-430b-95c9-a87e9f3e934c">!function(){"use strict";!function(e,n){var r=[];function t(e){return function(){r.push([e,arguments])}}n.Raven={captureException:t("captureException"),captureMessage:t("captureMessage"),captureBreadcrumb:t("captureBreadcrumb")};var a,o,c,i,s,u="undefined"!=typeof DOMError;function d(e){var n=e instanceof Error||e instanceof ErrorEvent||u&&e instanceof DOMError||e instanceof DOMException;Raven.captureException(n?e:new Error(e.message||e.reason))}n.addEventListener("unhandledrejection",d),n.addEventListener("error",d,!0),a=e.src,o=e,c=function(){r.forEach(function(e){var n;(n=Raven)[e[0]].apply(n,e[1])}),n.removeEventListener("unhandledrejection",d),n.removeEventListener("error",d,!0)},i=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("script")).crossOrigin=o.crossOrigin,s.dataset.sentryConfig=o["data-sentry-config"],s.onload=c,s.src=a,i.appendChild(s)}({"defer":true,"crossOrigin":"anonymous","src":"https://unpkg.zhimg.com/@cfe/sentry-script@1.3.1/dist/init.js","data-sentry-config":"{\"dsn\":\"https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224\",\"sampleRate\":0.1,\"release\":\"1187-6162a094\",\"ignoreErrorNames\":[\"NetworkError\",\"SecurityError\"],\"ignoreErrorsPreset\":\"ReactApp\",\"tags\":{\"app_name\":\"heifetz\"}}"},window)}();
</script></head><body><div id="root"><div><style data-emotion-css="55n9hh">.css-55n9hh{position:fixed;top:0;right:0;left:0;z-index:101;display:none;height:2px;pointer-events:none;background:#1772F6;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}</style><div class="LoadingBar  css-55n9hh"></div><div><style data-emotion-css="17rnw55">.css-17rnw55{background-color:#ffffff;-webkit-transition-property:background-color,box-shadow;transition-property:background-color,box-shadow;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}</style><header role="banner" class="Sticky AppHeader css-17rnw55" data-za-module="TopNavBar"><style data-emotion-css="11p8nt5">.css-11p8nt5{width:auto;max-width:1156px;min-width:1000px;padding-left:16px;padding-right:55px;}.css-11p8nt5 .AppHeader-userInfo{margin-left:30px;width:auto;}.css-11p8nt5 .AppHeader-TabsLink.is-active,.css-11p8nt5 .AppHeader-TabsLink:hover{color:#191B1F;}</style><div class="AppHeader-inner css-11p8nt5"><a href="//www.zhihu.com" aria-label="知乎"><style data-emotion-css="1hlrcxk">.css-1hlrcxk{-webkit-transition-property:fill;transition-property:fill;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}</style><svg viewBox="0 0 64 30" fill="#1772F6" width="64" height="30" class="css-1hlrcxk"><path d="M29.05 4.582H16.733V25.94h3.018l.403 2.572 4.081-2.572h4.815V4.582zm-5.207 18.69l-2.396 1.509-.235-1.508h-1.724V7.233h6.78v16.04h-2.425zM14.46 14.191H9.982c0-.471.033-.954.039-1.458v-5.5h5.106V5.935a1.352 1.352 0 0 0-.404-.957 1.378 1.378 0 0 0-.968-.396H5.783c.028-.088.056-.177.084-.255.274-.82 1.153-3.326 1.153-3.326a4.262 4.262 0 0 0-2.413.698c-.57.4-.912.682-1.371 1.946-.532 1.453-.997 2.856-1.31 3.693C1.444 8.674.28 11.025.28 11.025a5.85 5.85 0 0 0 2.52-.61c1.119-.593 1.679-1.502 2.054-2.883l.09-.3h2.334v5.5c0 .5-.045.982-.073 1.46h-4.12c-.71 0-1.39.278-1.893.775a2.638 2.638 0 0 0-.783 1.874h6.527a17.717 17.717 0 0 1-.778 3.649 16.796 16.796 0 0 1-3.012 5.273A33.104 33.104 0 0 1 0 28.74s3.13 1.175 5.425-.954c1.388-1.292 2.631-3.814 3.23-5.727a28.09 28.09 0 0 0 1.12-5.229h5.967v-1.37a1.254 1.254 0 0 0-.373-.899 1.279 1.279 0 0 0-.909-.37z"></path><path d="M11.27 19.675l-2.312 1.491 5.038 7.458a6.905 6.905 0 0 0 .672-2.218 3.15 3.15 0 0 0-.28-2.168l-3.118-4.563zM51.449 15.195V5.842c4.181-.205 7.988-.405 9.438-.483l.851-.05c.387-.399.885-2.395.689-3.021-.073-.25-.213-.666-.638-.555a33.279 33.279 0 0 1-4.277.727c-2.766.321-3.97.404-7.804.682-6.718.487-12.709.72-12.709.72a2.518 2.518 0 0 0 .788 1.834 2.567 2.567 0 0 0 1.883.706c2.278-.095 5.598-.25 8.996-.41v9.203h-12.78c0 .703.281 1.377.783 1.874a2.69 2.69 0 0 0 1.892.777h10.105v7.075c0 .887-.464 1.192-1.231 1.214h-3.92a4.15 4.15 0 0 0 .837 1.544 4.2 4.2 0 0 0 1.403 1.067 6.215 6.215 0 0 0 2.71.277c1.36-.066 2.967-.826 2.967-3.57v-7.607h11.28c.342 0 .67-.135.91-.374.242-.239.378-.563.378-.902v-1.375H51.449z"></path><path d="M42.614 8.873a2.304 2.304 0 0 0-1.508-.926 2.334 2.334 0 0 0-1.727.405l-.376.272 4.255 5.85 2.24-1.62-2.884-3.98zM57.35 8.68l-3.125 4.097 2.24 1.663 4.517-5.927-.375-.277a2.32 2.32 0 0 0-1.722-.452 2.327 2.327 0 0 0-1.536.896z"></path></svg></a><style data-emotion-css="g0ay3v">.css-g0ay3v{margin-left:25px;margin-right:15px;}.css-g0ay3v .AppHeader-Tab{padding-left:15px;padding-right:15px;}.css-g0ay3v .Tabs-link.is-active::after{height:4px;}</style><ul role="tablist" class="Tabs AppHeader-Tabs css-g0ay3v"><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><style data-emotion-css="1fb8pjf">.css-1fb8pjf{color:undefined !important;-webkit-transition-property:color;transition-property:color;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}.css-1fb8pjf.is-active,.css-1fb8pjf:hover{opacity:1;}.css-1fb8pjf.is-active::after{background-color:#1772F6 !important;}</style><a class="Tabs-link AppHeader-TabsLink css-1fb8pjf" tabindex="0" data-za-not-track-link="true" href="//www.zhihu.com/">首页</a></li><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><a class="Tabs-link AppHeader-TabsLink css-1fb8pjf" tabindex="0" data-za-not-track-link="true" href="//www.zhihu.com/education/learning">知乎知学堂</a></li><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><a class="Tabs-link AppHeader-TabsLink css-1fb8pjf" tabindex="0" data-za-not-track-link="true" href="//www.zhihu.com/explore">发现</a></li><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><a class="Tabs-link AppHeader-TabsLink css-1fb8pjf" tabindex="0" data-za-not-track-link="true" href="//www.zhihu.com/question/waiting">等你来答</a></li></ul><style data-emotion-css="1acwmmj">.css-1acwmmj{box-sizing:border-box;margin:0;min-width:0;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-1acwmmj"><style data-emotion-css="10fy1q8">.css-10fy1q8{max-width:482px;}.css-10fy1q8 .SearchBar-input{border-radius:999px;padding-left:16px;}.css-10fy1q8 .SearchBar-askButton{border-radius:999px;width:70px;margin-left:12px;}.css-10fy1q8 .SearchBar-searchButton{border-bottom-right-radius:999px;border-top-right-radius:999px;}</style><div class="SearchBar css-10fy1q8" role="search" data-za-module="PresetWordItem"><form class="SearchBar-tool"><div><div class="Popover"><style data-emotion-css="11bw1mm">.css-11bw1mm{border-color:undefined !important;-webkit-transition-property:background-color,border,color;transition-property:background-color,border,color;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}.css-11bw1mm{border-color:undefined !important;-webkit-transition-property:background-color,border,color;transition-property:background-color,border,color;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}.css-11bw1mm{border-color:undefined !important;-webkit-transition-property:background-color,border,color;transition-property:background-color,border,color;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}.css-11bw1mm{border-color:undefined !important;-webkit-transition-property:background-color,border,color;transition-property:background-color,border,color;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}</style><label class="SearchBar-input css-11bw1mm Input-wrapper QZcfWkCJoarhIYxlM_sG Input-wrapper--grey evPjxqnqXpIBzSRrcIDv"><input type="text" maxLength="100" value="" autoComplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="null--1" id="null-toggle" aria-haspopup="true" aria-owns="null-content" class="Input i7cW1UcwT6ThdhTakqFm" placeholder=""/><button aria-label="搜索" type="button" class="Button SearchBar-searchButton FEfUrdfMIKpQDJDqkjte Button--primary epMJl0lFQuYbC7jrwr_o"><style data-emotion-css="1dlt5yv">.css-1dlt5yv{-webkit-transition-property:color;transition-property:color;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}.css-1dlt5yv:hover{opacity:1;}</style><span style="display:inline-flex;align-items:center">​<svg width="18" height="18" viewBox="0 0 24 24" class="Zi Zi--Search SearchBar-searchIcon css-1dlt5yv" fill="currentColor"><path fill-rule="evenodd" d="M11.8 2.425a9.075 9.075 0 1 0 5.62 16.201l2.783 2.783a.875.875 0 1 0 1.238-1.237l-2.758-2.758A9.075 9.075 0 0 0 11.8 2.425ZM4.475 11.5a7.325 7.325 0 1 1 14.65 0 7.325 7.325 0 0 1-14.65 0Z" clip-rule="evenodd"></path></svg></span></button></label></div></div></form></div></div><div class="AppHeader-userInfo"><div><div class="Popover"><style data-emotion-css="d5yzzu">.css-d5yzzu{box-sizing:border-box;margin:0;min-width:0;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-right:20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content" type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--gray fEPKGkUK5jyc4fUuT0QP css-d5yzzu">切换模式</div></div></div><div class="AppHeader-profile"><div><style data-emotion-css="1ay9vb9">.css-1ay9vb9{margin-right:16px;}</style><style data-emotion-css="1rwz7is">.css-1rwz7is{display:inline-block;padding:0 16px;font-size:14px;line-height:32px;color:#ffffff;text-align:center;cursor:pointer;background:none;border:1px solid;border-radius:3px;background-color:#1772F6;border-color:#1772F6;margin-right:16px;}.css-1rwz7is::mozFocusInner{padding:0;border:0;}.css-1rwz7is:focus{outline:none;-webkit-transition:box-shadow 0.3s;transition:box-shadow 0.3s;}.css-1rwz7is:focus-visible{box-shadow:0 0 0 2px #ffffff,0 0 0 4px rgba(23,114,246,0.3);}.css-1rwz7is:disabled{cursor:default;opacity:0.5;}.css-1rwz7is:hover{border-color:#0a6af5;background-color:#0a6af5;}</style><button type="button" class="Button Button--primary Button--blue css-1rwz7is">登录/注册</button><style data-emotion-css="1fv1gmw">.css-1fv1gmw{position:fixed;bottom:50px;right:64px;width:336px;z-index:2;}</style></div></div></div></div><div></div></header></div><div><span style="position:absolute;top:-10000px;left:-10000px" role="log" aria-live="assertive"></span></div><main role="main" class="App-main"><div><div class="QuestionPage" itemscope="" itemProp="mainEntity" itemType="http://schema.org/Question"><meta itemProp="name" content="mysql 优化方法有哪些？"/><meta itemProp="url" content="https://www.zhihu.com/question/486575193"/><meta itemProp="keywords" content="数据库,面试,MySQL,MySQL 入门,MySQL DBA"/><meta itemProp="answerCount" content="42"/><meta itemProp="commentCount" content="0"/><meta itemProp="dateCreated" content="2021-09-13T07:42:01.000Z"/><meta itemProp="dateModified" content="2021-09-13T07:42:01.000Z"/><meta itemProp="zhihu:visitsCount"/><meta itemProp="zhihu:followerCount" content="367"/><div data-zop-question="{&quot;title&quot;:&quot;mysql 优化方法有哪些？&quot;,&quot;topics&quot;:[{&quot;name&quot;:&quot;数据库&quot;,&quot;id&quot;:&quot;19552067&quot;},{&quot;name&quot;:&quot;面试&quot;,&quot;id&quot;:&quot;19552079&quot;},{&quot;name&quot;:&quot;MySQL&quot;,&quot;id&quot;:&quot;19554128&quot;},{&quot;name&quot;:&quot;MySQL 入门&quot;,&quot;id&quot;:&quot;19667043&quot;},{&quot;name&quot;:&quot;MySQL DBA&quot;,&quot;id&quot;:&quot;20075899&quot;}],&quot;id&quot;:486575193,&quot;isEditable&quot;:false}"><div><div class="QuestionHeader"><div class="QuestionHeader-content"><div class="QuestionHeader-main"><div class="QuestionHeader-tags"><div class="QuestionHeader-topics"><style data-emotion-css="ch8ocw">.css-ch8ocw{position:relative;display:inline-block;height:30px;padding:0 12px;font-size:14px;line-height:30px;color:#1772F6;vertical-align:top;border-radius:100px;background:rgba(23,114,246,0.1);}.css-ch8ocw:hover{background-color:rgba(23,114,246,0.15);}</style><div class="Tag QuestionTopic css-ch8ocw"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19552067" target="_blank"><style data-emotion-css="1xlfegr">.css-1xlfegr{background:transparent;box-shadow:none;}</style><style data-emotion-css="1gomreu">.css-1gomreu{position:relative;display:inline-block;}</style><div class="css-1gomreu">数据库</div></a></span></div><div class="Tag QuestionTopic css-ch8ocw"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19552079" target="_blank"><div class="css-1gomreu">面试</div></a></span></div><div class="Tag QuestionTopic css-ch8ocw"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19554128" target="_blank"><div class="css-1gomreu">MySQL</div></a></span></div><div class="Tag QuestionTopic css-ch8ocw"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19667043" target="_blank"><div class="css-1gomreu">MySQL 入门</div></a></span></div><div class="Tag QuestionTopic css-ch8ocw"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/20075899" target="_blank"><div class="css-1gomreu">MySQL DBA</div></a></span></div></div></div><h1 class="QuestionHeader-title">mysql 优化方法有哪些？</h1><style data-emotion-css="4cffwv">.css-4cffwv{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-4cffwv"></div><div></div></div><div class="QuestionHeader-side"><div class="QuestionHeader-follow-status"><div class="QuestionFollowStatus"><div class="NumberBoard QuestionFollowStatus-counts NumberBoard--divider"><div class="NumberBoard-item"><div class="NumberBoard-itemInner"><div class="NumberBoard-itemName">关注者</div><strong class="NumberBoard-itemValue" title="367">367</strong></div></div><div class="NumberBoard-item"><div class="NumberBoard-itemInner"><div class="NumberBoard-itemName">被浏览</div><strong class="NumberBoard-itemValue" title="138059">138,059</strong></div></div></div></div></div></div></div><div class="QuestionHeader-footer"><div class="QuestionHeader-footer-inner"><div class="QuestionHeader-main QuestionHeader-footer-main"><div class="QuestionButtonGroup"><button type="button" class="Button FollowButton FEfUrdfMIKpQDJDqkjte Button--primary Button--blue epMJl0lFQuYbC7jrwr_o JmYzaky7MEPMFcJDLNMG">关注问题</button><a><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--blue JmYzaky7MEPMFcJDLNMG"><span style="display:inline-flex;align-items:center">​<svg width="16" height="16" viewBox="0 0 24 24" class="Zi Zi--Edit QuestionButton-icon" fill="currentColor"><path d="m7.841 20.043-4.328 1.18a.6.6 0 0 1-.737-.736l1.18-4.324a1.2 1.2 0 0 1 .314-.539l8.094-7.995a.9.9 0 0 1 1.268.003l2.736 2.736a.9.9 0 0 1 .004 1.268l-7.196 7.296-.802.802a1.2 1.2 0 0 1-.533.31ZM19.703 4.81l-.514-.513a2.542 2.542 0 0 0-3.595 0l-.999 1.067a.9.9 0 0 0 .02 1.252l2.77 2.768a.9.9 0 0 0 1.25.02l1.068-.999a2.542 2.542 0 0 0 0-3.594Z"></path></svg></span>写回答</button></a></div><div class="QuestionHeaderActions"><button style="margin-right:16px" type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--grey Button--withIcon Button--withLabel ZdfrHW7Ef5ZjwFiiBJuS B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Invite Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path fill-rule="evenodd" d="M5.5 7.5A5.5 5.5 0 0 1 11 2a5.5 5.5 0 0 1 5.5 5.5A5.5 5.5 0 0 1 11 13a5.5 5.5 0 0 1-5.5-5.5Zm8.11 9.498c.404-.408.91-1 1.17-1.51.067-.133.13-.284.165-.442.034-.15.058-.373-.033-.602a.872.872 0 0 0-.545-.509 1.37 1.37 0 0 0-.604-.043c-.657.082-1.518.184-2.373.24-.867.055-1.68.058-2.254-.041-1.189-.204-2.045-.19-2.781.087-.722.272-1.25.773-1.804 1.302-1.533 1.462-2.434 3.311-2.65 4.831-.11.78.535 1.339 1.199 1.339h8.1a.96.96 0 0 0 .955-.929c.06-1.767.7-2.96 1.456-3.723Zm5.596-2.292a.706.706 0 0 0-1.412 0v2.588h-2.588a.706.706 0 0 0 0 1.412h2.588v2.588a.706.706 0 1 0 1.412 0v-2.588h2.588a.706.706 0 0 0 0-1.412h-2.588v-2.588Z" clip-rule="evenodd"></path></svg></span>邀请回答</button><div class="GoodQuestionAction"><button type="button" class="Button GoodQuestionAction-commonBtn FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Like Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M9.912 1.14c2.482 0 4.322 2.7 3.5 6.263h4.29c2.488 0 4.313 2.347 3.71 4.77l-1.099 4.41a5.81 5.81 0 0 1-.684 1.634 6.118 6.118 0 0 1-5.215 2.924H6.072a3.599 3.599 0 0 1-3.592-3.606v-6.294c0-3.006 3.277-2.807 5-6.211 1.111-1.667.266-3.89 2.432-3.89Z"></path></svg></span>好问题 4</button></div><div class="QuestionHeader-Comment"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Comment Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>添加评论</button></div><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Share Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M19.47 1.914a.8.8 0 0 1 1.204.778l-1.872 16.386a.9.9 0 0 1-1.204.743l-4.615-1.692a.7.7 0 0 0-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 0 1 .179-.504l5.808-7.148a.595.595 0 0 0-.897-.781l-5.93 6.354a1.1 1.1 0 0 1-1.258.252L2.57 13.46a.8.8 0 0 1-.08-1.415l16.98-10.13Z"></path></svg></span>分享</button></div></div><div class="Popover"><button aria-label="更多" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content" type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--iconOnly fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY hIwDV_tcL6XN1HprrnAq"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Dots Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></span></button></div></div><div class="QuestionHeader-actions"></div></div></div></div></div></div><style data-emotion-css="1oxku7z">html{-webkit-scroll-padding-top:calc(52px + 2em);-moz-scroll-padding-top:calc(52px + 2em);-ms-scroll-padding-top:calc(52px + 2em);scroll-padding-top:calc(52px + 2em);-webkit-scroll-padding-bottom:56px;-moz-scroll-padding-bottom:56px;-ms-scroll-padding-bottom:56px;scroll-padding-bottom:56px;}</style><div><div class="Sticky"></div></div></div><style data-emotion-css="9hu0cu">.css-9hu0cu{width:1000px;}</style><style data-emotion-css="1mgcfmo">.css-1mgcfmo{box-sizing:border-box;margin:0;min-width:0;background-color:#f4f6f9;margin-top:10px;margin-left:auto;margin-right:auto;width:1000px;}</style><div id="AnswerFormPortalContainer" class="css-1mgcfmo"></div><div class="Question-main"><div class="ListShortcut"><div class="Question-mainColumn" data-zop-questionanswerlist="true"><div class="Question-mainColumnLogin"><div class="Question-mainColumnLoginImg"><svg width="43" height="50" viewBox="0 0 43 50" fill="none"><path fill="#121212" d="M23.376 45.237c-1.567 0-3.133.012-4.698 0a1.701 1.701 0 0 0-1.133.386 507.16 507.16 0 0 1-4.493 3.517 3.959 3.959 0 0 1-.694.449 1.305 1.305 0 0 1-1.792-1.537c.239-.737.477-1.47.744-2.192.158-.42.153-.597-.384-.68-1.963-.3-3.672-1.093-4.879-2.756a7.614 7.614 0 0 1-1.272-2.983c-.098-.477-.238-.455-.651-.317-.625.212-.783.568-.601 1.16.041.155.057.316.047.477a.988.988 0 0 1-.806 1.03.954.954 0 0 1-1.162-.589c-.115-.257-.189-.417-.527-.408a1.009 1.009 0 0 1-1.003-.701c-.188-.463.015-.828.337-1.112.238-.22.238-.356.067-.625a1.023 1.023 0 0 1 .238-1.432.98.98 0 0 1 1.377.203c.293.348.542.344.966.227 1.315-.365 1.974-1.088 1.99-2.534.015-1.239.346-2.467.494-3.706.158-1.314-.1-2.61-.258-3.905-.205-1.67-.477-3.34-.742-4.992-.136-.89.44-1.462 1.325-1.312 1.119.186 1.104.183 1.255-.955.224-1.689.45-3.376.715-5.058a1.102 1.102 0 0 0-.522-1.243C5.336 12.284 4.34 10.273 3.93 7.954c-.462-2.57.65-4.554 2.53-6.175C8.34.156 10.609-.166 12.993.068a11.67 11.67 0 0 1 3.884 1.028 5.311 5.311 0 0 1 2.147 1.728c.303.436.645.541 1.138.539 4.362-.017 8.721 0 13.08 0 1.776 0 3.415.413 4.813 1.563 2.04 1.67 2.784 3.87 2.558 6.442-.009.08-.023.16-.04.239-.178.954-.21 1.655.715 2.479a4.5 4.5 0 0 1 .386 6.15 13.421 13.421 0 0 1-2.2 2.246 1.322 1.322 0 0 0-.548.928c-.604 4.355-1.267 8.7-1.814 13.06-.539 4.327-3.407 7.65-7.566 8.59-.876.169-1.768.235-2.66.198H23.38l-.003-.021z"></path><path fill="#FEFEFE" d="M12.394 47.606c.441-1.293.809-2.417 1.21-3.526.136-.377 0-.442-.335-.444-.715 0-1.431-.019-2.147-.07-1.346-.095-2.458-.698-3.412-1.624a1.357 1.357 0 0 1-.425-1.105c.046-.93.062-1.863.062-2.794a.614.614 0 0 1 .492-.692c.513-.148 1.014-.338 1.517-.517.442-.156.642-.478.509-.929-.144-.477-.537-.532-.955-.41-.322.09-.64.21-.954.31-.403.13-.601 0-.592-.446.02-.89 0-1.782.024-2.675.05-2.944-.33-5.85-.775-8.751-.02-.117-.043-.239-.055-.351-.046-.535.086-.659.606-.53 1.095.267 2.2.504 3.278.833 1.67.51 3.329.365 4.975-.1 1.97-.559 3.798-1.473 5.64-2.343a1.038 1.038 0 0 0 .604-.955c.072-1.047.16-2.095.238-3.14.048-.61.184-.715.747-.477 1.625.628 3.252 1.25 4.865 1.909a3.12 3.12 0 0 0 2.195.074c1.73-.558 3.348-1.413 5.018-2.114.745-.306.768-.306 1.074.458.532 1.322 1.038 2.653 1.603 3.963.191.444.079.695-.265.954a37.672 37.672 0 0 1-4.576 2.976c-.833.463-.883.568-.716 1.517.838 4.57 1.217 9.189 1.556 13.813a1.209 1.209 0 0 1-.44 1.085c-1.631 1.494-3.552 2.148-5.752 2.148-3.101-.029-6.184 0-9.276 0a1.432 1.432 0 0 0-1 .374c-1.436 1.179-2.93 2.317-4.538 3.58z"></path><path fill="#06F" d="M32.376 15.823a3.172 3.172 0 0 0-.04-.366c-.284-1.171.035-2.087 1.026-2.834.584-.441.61-.926.293-1.403s-.78-.573-1.45-.239c-.24.122-.299.072-.356-.157a1.583 1.583 0 0 0-.212-.477.936.936 0 0 0-1.14-.408.995.995 0 0 0-.693 1.062c.023.211.06.42.112.627-.365-.05-.69-.239-1.05-.086a.99.99 0 0 0-.675.759.869.869 0 0 0 .415.973c.392.239.802.427 1.215.62a.548.548 0 0 1 .394.52c.023.655.076 1.308.133 1.957a.46.46 0 0 1-.327.542 2.832 2.832 0 0 1-2.343.05c-1.894-.8-3.817-1.517-5.743-2.26-.97-.376-1.536-.028-1.63 1.005-.114 1.262-.238 2.524-.312 3.791a.809.809 0 0 1-.51.78c-1.797.83-3.594 1.67-5.56 2.031a6.441 6.441 0 0 1-2.708-.06c-.752-.176-1.494-.398-2.248-.555-.36-.075-.439-.24-.39-.568.28-1.922.552-3.843.813-5.765.043-.322.183-.418.477-.336.424.112.871.104 1.29-.024.492-.132.82.045 1.163.365a8.126 8.126 0 0 0 3.209 1.849c.828.239 1.243-.11 1.08-.954-.142-.738-.262-1.482-.443-2.212a1 1 0 0 1 .334-1.093 17.656 17.656 0 0 0 2.758-3.34c.821-1.272 1.265-2.642.954-4.171-.083-.418.063-.506.451-.506 4.18.012 8.363 0 12.544.012 1.708 0 3.242.477 4.435 1.782 1.29 1.42 1.484 3.102 1.336 4.94-.095 1.176-.522 1.791-1.732 2.147-1.489.434-2.878 1.21-4.309 1.837-.17.1-.363.157-.56.165z"></path><path fill="#FEFEFE" d="M14.94 15.307c-.871-.3-1.477-.87-2.088-1.431-.318-.291-.685-.477-1.129-.392-1.88.404-3.219-.587-4.4-1.806-1.479-1.53-2.2-3.426-1.892-5.538.33-2.25 2.699-4.328 4.99-4.56 1.838-.206 3.7.034 5.425.702 2.83 1.107 3.775 3.844 2.207 6.442a15.454 15.454 0 0 1-3.102 3.656.992.992 0 0 0-.367 1.143c.153.56.231 1.147.356 1.784z"></path><path fill="#06F" d="M35.01 38.244a128.668 128.668 0 0 0-.763-7.824 60.35 60.35 0 0 0-.527-3.464.584.584 0 0 1 .324-.716c.842-.52 1.67-1.062 2.51-1.59.146-.09.296-.295.463-.197.167.098.088.36.064.544-.226 1.652-.455 3.299-.687 4.939-.362 2.507-.73 5.014-1.105 7.523a1.38 1.38 0 0 1-.279.785z"></path><path fill="#B7B7B6" d="M37.792 17.19c-.238-.239-.353-.392-.303-.6 0-.03.13-.073.139-.061a.98.98 0 0 1 .164.66z"></path><path fill="#121212" d="M20.92 27.309c.025.954-.488 1.479-1.43 1.5-.943.022-1.633-.615-1.64-1.56-.007-.945.697-1.53 1.804-1.546.9-.012 1.231.42 1.267 1.606z"></path><path fill="#444" d="M11.938 5.575c.172-.137.35-.265.537-.382a.804.804 0 0 1 1.178.294c.378.652.654 1.358.816 2.094.1.38-.176.432-.43.492-.252.06-.522.112-.6-.265-.094-.444-.172-.895-.308-1.329-.079-.255-.131-.656-.563-.518-.396.124-.477.416-.31.802.183.44.312.897.491 1.336.217.535-.2.623-.518.728-.317.105-.749.339-.93-.239a33.209 33.209 0 0 1-.897-3.567c-.098-.477.26-.553.584-.651.325-.098.575-.045.673.348.072.289.074.6.277.857zM9.266 9.09l.954-.356c.191-.067.356-.048.442.165a.32.32 0 0 1-.047.376.322.322 0 0 1-.11.077 9.983 9.983 0 0 1-2.172.775c-.446.093-.675-.238-.525-.715.22-.697.477-1.38.733-2.09-.332-.077-.616.095-.912.166-.186.046-.358.074-.453-.143a.354.354 0 0 1 .179-.5c.67-.302 1.4-.445 2.133-.42.415.018.551.338.422.737-.196.591-.398 1.188-.644 1.927zm6.461-1.544c-.289.043-.458-.096-.55-.39-.15-.477-.238-.954-.355-1.43-.152-.597.208-.74.626-.862.46-.136.57.212.684.537.115.324.253.715.377 1.059.25.704-.002 1.064-.782 1.086z"></path><path fill="#4A4B4A" d="M15.037 3.055a.77.77 0 0 1 .75.77.728.728 0 0 1-.779.745.716.716 0 0 1-.741-.751c.028-.485.324-.707.77-.764z"></path></svg></div><div class="Question-mainColumnLoginContent"><div class="Question-mainColumnLoginTitle">登录后你可以</div><div class="Question-mainColumnLoginDes"><span class="Question-mainColumnLoginDesIcon"><svg width="14" height="14" viewBox="0 0 14 14" fill="none"><mask id="id-628033106-a" width="14" height="14" x="0" y="0" maskUnits="userSpaceOnUse"><path fill="#fff" fill-rule="evenodd" d="M.001.014h13.985V14H.001V.014z" clip-rule="evenodd"></path></mask><g mask="url(#id-628033106-a)"><path fill="#121212" fill-rule="evenodd" d="M2.543 8.278a.636.636 0 0 1 0 1.272h-.636A1.907 1.907 0 0 1 0 7.643V1.92C0 .868.854.014 1.907.014H7.63c1.053 0 1.907.854 1.907 1.907v.636a.636.636 0 0 1-1.271 0V1.92a.636.636 0 0 0-.636-.636H1.907a.636.636 0 0 0-.636.636v5.722c0 .35.285.635.636.635h.636zm3.814-3.814h5.722c1.053 0 1.907.854 1.907 1.907v5.722A1.907 1.907 0 0 1 12.08 14H6.357a1.907 1.907 0 0 1-1.907-1.907V6.37c0-1.053.854-1.907 1.907-1.907zm0 1.271a.636.636 0 0 0-.635.636v5.722c0 .35.284.636.635.636h5.722a.636.636 0 0 0 .636-.636V6.37a.636.636 0 0 0-.636-.636H6.357z" clip-rule="evenodd"></path></g></svg>不限量看优质回答</span><span class="Question-mainColumnLoginDesIcon"><svg width="15" height="14" viewBox="0 0 15 14" fill="none"><path fill="#121212" fill-rule="evenodd" d="M3.55 14c-.106 0-.159 0-.265-.053a.583.583 0 0 1-.318-.53v-2.225H.954A.95.95 0 0 1 0 10.238V.965A.95.95 0 0 1 .954.01h12.982a.95.95 0 0 1 .954.954v9.273a.95.95 0 0 1-.954.954H7.418l-3.497 2.702c-.106.053-.212.106-.37.106zm-2.49-3.921h2.437c.318 0 .53.212.53.53v1.854l2.914-2.225c.106-.053.212-.106.318-.106h6.518V1.124H1.06v8.955z" clip-rule="evenodd"></path><path fill="#121212" fill-rule="evenodd" d="M3.709 4.515h7.948v-1.06H3.71v1.06zm0 3.18h4.239v-1.06H3.709v1.06z" clip-rule="evenodd"></path></svg>私信答主深度交流</span><span class="Question-mainColumnLoginDesIcon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><mask id="id-95574191-a" width="16" height="16" x="0" y="0" maskUnits="userSpaceOnUse"><path fill="#fff" fill-rule="evenodd" d="M.001.016h15.983V16H.001V.016z" clip-rule="evenodd"></path></mask><g mask="url(#id-95574191-a)"><path fill="#121212" fill-rule="evenodd" d="M7.992.016C3.585.016 0 3.6 0 8.008a7.96 7.96 0 0 0 1.344 4.435.521.521 0 0 0 .867-.58 6.915 6.915 0 0 1-1.169-3.855 6.958 6.958 0 0 1 6.95-6.95 6.958 6.958 0 0 1 6.95 6.95 6.958 6.958 0 0 1-6.95 6.95 6.917 6.917 0 0 1-3.865-1.175.522.522 0 0 0-.58.866A7.956 7.956 0 0 0 7.992 16c4.407 0 7.992-3.585 7.992-7.992S12.4.016 7.992.016zM5.046 8.368c-.221 0-.332-.096-.332-.29V7.29c0-.216.111-.323.332-.323h2.167a4.28 4.28 0 0 1-.394 1.401H5.046zm3.14-1.401h2.746a.47.47 0 0 1 .28.071c.058.041.086.125.086.252v.845c0 .155-.12.233-.366.233H7.873a8.4 8.4 0 0 0 .314-1.401zm-2.964 3.316c-.386.266-.945.508-1.677.727v.822c.301-.032.542-.069.722-.11a4.708 4.708 0 0 0 1.63-.774c.558-.409 1.07-.976 1.54-1.701h.712v1.615c0 .33.098.572.294.727.178.143.404.214.68.214h3.206V10.9H9.426c-.126 0-.218-.023-.275-.07-.054-.045-.079-.142-.076-.29l.005-1.293h2.166a.98.98 0 0 0 .703-.261c.155-.149.233-.376.233-.68V7.03c0-.311-.085-.545-.256-.704-.105-.098-.268-.172-.49-.223l.252-.58c.073-.168.11-.308.11-.422a.823.823 0 0 0-.276-.608c-.187-.187-.444-.28-.77-.28h-5.14l.137-.47h-.893c-.161.449-.327.778-.498.987-.206.257-.447.412-.723.466v.907a2.96 2.96 0 0 0 .908-.404 3 3 0 0 0 .622-.608h5.221c.188 0 .304.013.352.038.073.038.109.092.109.162s-.03.175-.095.318l-.21.46H5.09c-.478 0-.805.083-.983.248-.187.177-.28.43-.28.76V8.26c0 .491.202.804.607.94.096.032.288.048.576.048h1.287c-.37.46-.728.805-1.074 1.036z" clip-rule="evenodd"></path></g></svg>精彩内容一键收藏</span></div></div><div class="Question-mainColumnLoginRightButton"><div><button type="button" class="Button Question-mainColumnLoginButton FEfUrdfMIKpQDJDqkjte">登录</button></div></div></div><div class="Card ViewAll"><a href="/question/486575193" class="QuestionMainAction ViewAll-QuestionMainAction" data-za-detail-view-element_name="ViewAll">查看全部 42 个回答</a></div><div class="Card AnswerCard css-0"><div class="QuestionAnswer-content" tabindex="0"><div><div class="ContentItem AnswerItem" data-zop="{&quot;authorName&quot;:&quot;蝉沐风&quot;,&quot;itemId&quot;:2425182871,&quot;title&quot;:&quot;mysql 优化方法有哪些？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="2425182871" itemProp="mainEntityOfPage" itemType="http://schema.org/Answer" itemscope=""><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemProp="author" itemscope="" itemType="http://schema.org/Person"><div class="AuthorInfo"><meta itemProp="name" content="蝉沐风"/><meta itemProp="image" content="https://pica.zhimg.com/03ee281e7d4710596689e547f345f53a_l.jpg?source=2c26e567"/><meta itemProp="url" content="https://www.zhihu.com/people/chanmufeng"/><meta itemProp="zhihu:followerCount"/><span class="UserLink AuthorInfo-avatarWrapper"><a href="//www.zhihu.com/people/chanmufeng" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User"><style data-emotion-css="icip60">.css-icip60{border-radius:2px;}</style><style data-emotion-css="1hx3fyn">.css-1hx3fyn{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:38px;height:38px;border-radius:2px;}</style><img class="Avatar AuthorInfo-avatar css-1hx3fyn" src="https://pica.zhimg.com/03ee281e7d4710596689e547f345f53a_l.jpg?source=2c26e567" srcSet="https://pica.zhimg.com/03ee281e7d4710596689e547f345f53a_l.jpg?source=2c26e567 2x" alt="蝉沐风"/></a></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><a href="//www.zhihu.com/people/chanmufeng" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User">蝉沐风</a><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="4gq0sj">.css-4gq0sj{box-sizing:border-box;margin:0;min-width:0;color:#09408e;display:inline-block;margin-left:.3em;}</style><a href="https://www.zhihu.com/question/48510028" target="_blank" class="css-4gq0sj" aria-label="山东大学 管理学硕士在读" data-tooltip="山东大学 管理学硕士在读"><style data-emotion-css="18biwo">.css-18biwo{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><span class="css-18biwo">​<style data-emotion-css="1ifz0go">.css-1ifz0go{overflow:visible!important;}</style><svg viewBox="0 0 24 24" class="css-1ifz0go" width="18" height="18"><defs><linearGradient id="biz-badges-blue" x1="0" y1="0" x2="100%" y2="73.32%"><stop offset="15%" stop-color="#47D3FF"></stop><stop offset="81.54%" stop-color="#4A7DFF"></stop></linearGradient></defs><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#ffffff" width="30" height="30"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"></path></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="url(#biz-badges-blue)"></path><svg class="Zi Zi--Check" fill="#fff" x="6" y="6" viewBox="0 0 24 24" width="12" height="12"><path d="M10.229 17.516c-.318.327-.75.484-1.199.484-.453 0-.884-.16-1.202-.488l-4.335-4.47a1.77 1.77 0 0 1 .007-2.459 1.663 1.663 0 0 1 2.397.01l3.137 3.246 9.072-9.329a1.662 1.662 0 0 1 2.397 0c.663.681.663 1.786 0 2.466L10.23 17.516z" fill-rule="evenodd"></path></svg></svg></span></a></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><style data-emotion-css="14ur8a8">.css-14ur8a8.AuthorInfo-badgeText{display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;width:490px;white-space:unset;}</style><div class="ztext AuthorInfo-badgeText css-14ur8a8">山东大学 管理学硕士在读</div></div></div></div></div><style data-emotion-css="upmq18">.css-upmq18{min-width:74px;padding:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}</style><button type="button" class="Button FollowButton css-upmq18 FEfUrdfMIKpQDJDqkjte Button--secondary Button--blue E211w_M7Hzs0GMB7BEyA JmYzaky7MEPMFcJDLNMG"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--PlusFill24" fill="currentColor"><path fill-rule="evenodd" d="M13.25 3.25a1.25 1.25 0 1 0-2.5 0v7.5h-7.5a1.25 1.25 0 1 0 0 2.5h7.5v7.5a1.25 1.25 0 1 0 2.5 0v-7.5h7.5a1.25 1.25 0 0 0 0-2.5h-7.5v-7.5Z" clip-rule="evenodd"></path></svg></span> 关注</button><style data-emotion-css="124ezq8">.css-124ezq8{position:absolute;bottom:0;right:0;width:1px;height:1px;}</style><div class="css-124ezq8"></div></div></div><meta itemProp="image"/><meta itemProp="upvoteCount" content="66"/><meta itemProp="url" content="https://www.zhihu.com/question/486575193/answer/2425182871"/><meta itemProp="dateCreated" content="2022-04-05T23:54:58.000Z"/><meta itemProp="dateModified" content="2022-04-05T23:54:58.000Z"/><meta itemProp="commentCount" content="5"/><div class="RichContent RichContent--unescapable"><span><div class="RichContent-inner"><style data-emotion-css="376mun">.css-376mun{position:relative;display:inline;}</style><div class="css-376mun"><style data-emotion-css="dg64xe">.css-dg64xe .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-dg64xe .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-dg64xe .FileLinkCard-info{margin-left:12px;}.css-dg64xe .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-dg64xe .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-dg64xe .FileLinkCard-source{white-space:pre;}.css-dg64xe img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-dg64xe img.content_image[data-size="normal"],.css-dg64xe img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-dg64xe img.content_image[data-size="small"],.css-dg64xe img.origin_image[data-size="small"]{width:320px;max-width:100%;}</style><style data-emotion-css="1vqsdx1">.css-1vqsdx1 .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-1vqsdx1 .LinkCard.new,.css-1vqsdx1 .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1vqsdx1 .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1vqsdx1 .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1vqsdx1 .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-1vqsdx1 .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1vqsdx1 .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1vqsdx1 .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-1vqsdx1 .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-1vqsdx1 .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1vqsdx1 .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1vqsdx1 .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1vqsdx1 .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1vqsdx1 .LinkCard.old,.css-1vqsdx1 .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}</style><style data-emotion-css="yxro2d">.css-yxro2d .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-yxro2d .LinkCard.old,.css-yxro2d .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yxro2d .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-yxro2d .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-yxro2d .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-yxro2d .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-yxro2d .LinkCard.new,.css-yxro2d .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yxro2d .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-yxro2d .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-yxro2d .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-yxro2d .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yxro2d .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-yxro2d .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-yxro2d .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-yxro2d .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-yxro2d .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-yxro2d .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-yxro2d .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-yxro2d .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-yxro2d .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-yxro2d .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-yxro2d .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-yxro2d .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-yxro2d .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-yxro2d .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-yxro2d .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-yxro2d .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-yxro2d .FileLinkCard-info{margin-left:12px;}.css-yxro2d .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yxro2d .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-yxro2d .FileLinkCard-source{white-space:pre;}.css-yxro2d img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-yxro2d img.content_image[data-size="normal"],.css-yxro2d img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-yxro2d img.content_image[data-size="small"],.css-yxro2d img.origin_image[data-size="small"]{width:320px;max-width:100%;}</style><style data-emotion-css="jflero animation-1yvu044">.css-jflero{word-break:break-word;line-height:1.6;}.css-jflero > [data-first-child]{margin-top:0;}.css-jflero > :last-child{margin-bottom:0;}.css-jflero h1,.css-jflero h2{clear:left;margin-top:calc((1.4em * 2) / 1.2);margin-bottom:calc(1.4em / 1.2);font-size:1.2em;line-height:1.5;font-weight:600;}.css-jflero h3,.css-jflero h4,.css-jflero h5,.css-jflero h6{clear:left;margin-top:calc((1.4em * 1.5) / 1.1);margin-bottom:calc(1.4em / 1.1);font-size:1.1em;line-height:1.5;font-weight:600;}.css-jflero u{-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #373a40;}.css-jflero b{font-weight:600;}.css-jflero sup{font-size:0.8em;}.css-jflero sup[data-draft-type='reference']{color:#09408e;}.css-jflero a:focus{outline:none;-webkit-transition:box-shadow 0.3s;transition:box-shadow 0.3s;}html[data-focus-visible] .css-jflero a:focus{box-shadow:0 0 0 2px #ffffff,0 0 0 4px rgba(23,114,246,0.3);}.css-jflero a.ztext-link,.css-jflero a.internal,.css-jflero a.external{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;border-bottom:1px solid #81858f;}.css-jflero a.ztext-link:hover,.css-jflero a.internal:hover,.css-jflero a.external:hover{color:#09408e;border-bottom:1px solid #09408e;}.css-jflero a.ztext-link > .ellipsis::after,.css-jflero a.internal > .ellipsis::after,.css-jflero a.external > .ellipsis::after{content:'...';}.css-jflero a.ztext-link > .invisible,.css-jflero a.internal > .invisible,.css-jflero a.external > .invisible{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;}.css-jflero a.ztext-link u,.css-jflero a.internal u,.css-jflero a.external u{border:none;}.css-jflero a.member_mention{color:#09408e;}.css-jflero a.member_mention:hover{border-bottom:1px solid #09408e;}.css-jflero a.UserLink-link{color:#09408e;}.css-jflero a.UserLink-link:hover{border-bottom:1px solid #09408e;}.css-jflero p{margin:1.4em 0;}.css-jflero p.ztext-empty-paragraph{margin:calc((2.8em- (1.4em * 2 + 1.6em)) / 2) 0;}.css-jflero p.ztext-empty-paragraph + .ztext-empty-paragraph{margin:1.4em 0;}.css-jflero hr{margin:4em auto;width:240px;max-width:100%;border:none;border-top:1px solid #c4c7ce;}.css-jflero img[eeimg]{max-width:100%;vertical-align:middle;}.css-jflero img[eeimg="1"]{margin:0 3px;max-width:calc(100% - 6px);display:inline-block;}.css-jflero img[eeimg="2"]{margin:1.4em auto;display:block;}.css-jflero blockquote{margin:1.4em 0;padding-left:1em;color:#535861;border-left:3px solid #c4c7ce;}.css-jflero ol,.css-jflero ul{margin:1.4em 0;padding:0;width:100%;}.css-jflero ol ol,.css-jflero ul ol,.css-jflero ol ul,.css-jflero ul ul{margin:0;}.css-jflero ol li::before,.css-jflero ul li::before{width:1em;}.css-jflero ol > ol,.css-jflero ul > ol,.css-jflero ol > ul,.css-jflero ul > ul{padding-left:1em;box-sizing:border-box;}.css-jflero ul>li{display:table;width:100%;list-style:none;}.css-jflero ul>li::before{display:table-cell;content:'•  ';white-space:pre;}.css-jflero ol{counter-reset:ol;}.css-jflero ol > li{display:table;width:100%;list-style:none;}.css-jflero ol > li::before{display:table-cell;text-align:right;counter-increment:ol;content:counter(ol) '. ';white-space:pre;}.css-jflero ol ol{counter-reset:ol2;}.css-jflero ol ol li::before{counter-increment:ol2;content:counter(ol2) '. ';}.css-jflero ol ol ol{counter-reset:ol3;}.css-jflero ol ol ol li::before{counter-increment:ol3;content:counter(ol3) '. ';}.css-jflero ol ol ol ol{counter-reset:ol4;}.css-jflero ol ol ol ol li::before{counter-increment:ol4;content:counter(ol4) '. ';}.css-jflero figure{margin:1.4em 0;}.css-jflero figure .content_image,.css-jflero figure .origin_image{margin:0 auto;}.css-jflero figure figcaption{margin-top:calc(0.6em / 0.9);padding:0 1em;font-size:0.9em;line-height:1.5;text-align:center;color:#9196a1;}.css-jflero figure + figure{margin-top:calc(1.4em * 1.6);}.css-jflero figure[data-size='small'],.css-jflero figure:not([data-size]) > [data-size='small']{clear:both;}.css-jflero figure[data-size='left'],.css-jflero figure:not([data-size]) > [data-size='left']{float:left;margin:0 20px 20px 0;max-width:33%;}.css-jflero figure[data-size='right'],.css-jflero figure:not([data-size]) > [data-size='right']{float:right;margin:0 0 20px 20px;max-width:33%;}.css-jflero figure[data-size='collapse']{margin-bottom:0;}.css-jflero figure[data-size='collapse'] + figure{margin-top:0;}.css-jflero .content_image,.css-jflero .origin_image{display:block;max-width:100%;height:auto;margin:1.4em auto;}.css-jflero .content_image[data-size='small'],.css-jflero .origin_image[data-size='small']{max-width:40%;}.css-jflero .content_image.zh-lightbox-thumb,.css-jflero .origin_image.zh-lightbox-thumb{cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in;}.css-jflero code{margin:0 2px;padding:3px 4px;border-radius:3px;font-family:Menlo,Monaco,Consolas,'Andale Mono','lucida console','Courier New',monospace;font-size:0.9em;background-color:#f8f8fa;}.css-jflero pre{margin:1.4em 0;padding:calc(0.8em / 0.9);font-size:0.9em;word-break:initial;word-wrap:initial;white-space:pre;overflow:auto;-webkit-overflow-scrolling:touch;background:#f8f8fa;border-radius:4px;}.css-jflero pre code{margin:0;padding:0;font-size:inherit;border-radius:0;background-color:inherit;}.css-jflero li pre{white-space:pre-wrap;}.css-jflero table[data-draft-type='table']{border-collapse:collapse;font-size:15px;margin:1.4em auto;max-width:100%;table-layout:fixed;text-align:left;width:100%;}.css-jflero table[data-draft-type='table'][data-size='small']{min-width:260px;width:40%;}.css-jflero table[data-draft-type='table'][data-row-style='striped'] tr:nth-of-type(2n + 1){background:#f8f8fa;}.css-jflero table[data-draft-type='table'] td,.css-jflero table[data-draft-type='table'] th{border:1px solid #c4c7ce;line-height:24px;height:24px;padding:3px 12px;}.css-jflero table[data-draft-type='table'] th{background:#ebeced;color:#191B1F;font-weight:500;}.css-jflero .video-box,.css-jflero .link-box{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:1.4em 0;overflow:auto;white-space:normal;cursor:pointer;border:solid 1px #ebeced;border-radius:4px;}.css-jflero .lazy[data-lazy-status]{background-color:#f8f8fa;}.css-jflero .lazy[data-lazy-status="ok"]{background-color:transparent;-webkit-animation:animation-1yvu044 0.5s ease-in;animation:animation-1yvu044 0.5s ease-in;}.css-jflero .highlight{margin:1em 0;}.css-jflero .highlight pre{margin:0;}.css-jflero .highlight .hll{background-color:#f8f8fa;}.css-jflero .highlight .c{font-style:italic;color:#9196a1;}.css-jflero .highlight .err{color:#D95350;}.css-jflero .highlight .k{font-weight:600;}.css-jflero .highlight .o{font-weight:600;}.css-jflero .highlight .cm{font-style:italic;color:#9196a1;}.css-jflero .highlight .cp{font-weight:600;color:#9196a1;}.css-jflero .highlight .c1{font-style:italic;color:#9196a1;}.css-jflero .highlight .cs{font-style:italic;font-weight:600;color:#9196a1;}.css-jflero .highlight .gd{color:#F05159;}.css-jflero .highlight .ge{font-style:italic;}.css-jflero .highlight .gr{color:#D95350;}.css-jflero .highlight .gh{color:#9196a1;}.css-jflero .highlight .gi{color:#12b370;}.css-jflero .highlight .go{color:#81858f;}.css-jflero .highlight .gp{color:#535861;}.css-jflero .highlight .gs{font-weight:600;}.css-jflero .highlight .gu{color:#9196a1;}.css-jflero .highlight .gt{color:#D95350;}.css-jflero .highlight .kc{font-weight:600;}.css-jflero .highlight .kd{font-weight:600;}.css-jflero .highlight .kn{font-weight:600;}.css-jflero .highlight .kp{font-weight:600;}.css-jflero .highlight .kr{font-weight:600;}.css-jflero .highlight .kt{font-weight:600;color:#09408e;}.css-jflero .highlight .m{color:#1772F6;}.css-jflero .highlight .s{color:#D95350;}.css-jflero .highlight .na{color:#1772F6;}.css-jflero .highlight .nb{color:#1772F6;}.css-jflero .highlight .nc{font-weight:600;color:#09408e;}.css-jflero .highlight .no{color:#1772F6;}.css-jflero .highlight .ni{color:#6A5FF3;}.css-jflero .highlight .ne{font-weight:600;color:#D95350;}.css-jflero .highlight .nf{font-weight:600;color:#D95350;}.css-jflero .highlight .nn{color:#535861;}.css-jflero .highlight .nt{color:#09408e;}.css-jflero .highlight .nv{color:#1772F6;}.css-jflero .highlight .ow{font-weight:600;}.css-jflero .highlight .w{color:#adb1b7;}.css-jflero .highlight .mf{color:#1772F6;}.css-jflero .highlight .mh{color:#1772F6;}.css-jflero .highlight .mi{color:#1772F6;}.css-jflero .highlight .mo{color:#1772F6;}.css-jflero .highlight .sb{color:#D95350;}.css-jflero .highlight .sc{color:#D95350;}.css-jflero .highlight .sd{color:#D95350;}.css-jflero .highlight .s2{color:#D95350;}.css-jflero .highlight .se{color:#D95350;}.css-jflero .highlight .sh{color:#D95350;}.css-jflero .highlight .si{color:#D95350;}.css-jflero .highlight .sx{color:#D95350;}.css-jflero .highlight .sr{color:#A5542F;}.css-jflero .highlight .s1{color:#D95350;}.css-jflero .highlight .ss{color:#D95350;}.css-jflero .highlight .bp{color:#9196a1;}.css-jflero .highlight .vc{color:#1772F6;}.css-jflero .highlight .vg{color:#1772F6;}.css-jflero .highlight .vi{color:#1772F6;}.css-jflero .highlight .il{color:#1772F6;}.css-jflero .highlight::-webkit-scrollbar{width:6px;height:6px;}.css-jflero .highlight::-webkit-scrollbar-thumb:horizontal{background-color:rgba(25,27,31,0.5);border-radius:6px;}.css-jflero .highlight::-webkit-scrollbar-thumb:horizontal:hover{background-color:rgba(25,27,31,0.6);}.css-jflero .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-jflero .LinkCard.old,.css-jflero .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-jflero .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-jflero .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-jflero .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-jflero .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-jflero .LinkCard.new,.css-jflero .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-jflero .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-jflero .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-jflero .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-jflero .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-jflero .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-jflero .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-jflero .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-jflero .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-jflero .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-jflero .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-jflero .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-jflero .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-jflero .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-jflero .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-jflero .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-jflero .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-jflero .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-jflero .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-jflero .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-jflero .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-jflero .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-jflero .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-jflero .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-jflero .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-jflero .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-jflero .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-jflero .FileLinkCard-info{margin-left:12px;}.css-jflero .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-jflero .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-jflero .FileLinkCard-source{white-space:pre;}.css-jflero img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-jflero img.content_image[data-size="normal"],.css-jflero img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-jflero img.content_image[data-size="small"],.css-jflero img.origin_image[data-size="small"]{width:320px;max-width:100%;}@-webkit-keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}@keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}</style><span class="RichText ztext CopyrightRichText-richText css-jflero" options="[object Object]" itemProp="text"><p data-first-child data-pid="FxU_EVgy">面试官如果问你：你会从哪些维度进行MySQL性能优化？你会怎么回答？</p><p data-pid="RBXvF_MI">所谓的性能优化，一般针对的是MySQL查询的优化。既然是优化查询，我们自然要先知道查询操作要经过哪些环节，然后思考可以在哪些环节进行优化。</p><p data-pid="7Xa2jH66">我之前写过<b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI1MDU0MTc2MQ%3D%3D%26mid%3D2247484069%26idx%3D1%26sn%3Dd40d90ab9e3041757262be5192a46e9e%26chksm%3De981e10bdef6681dde2ede9c1293e4b379fb827ab3c7d64ae828311c4ee14e19e20d7537d5f0%23rd" class=" wrap external" target="_blank" rel="nofollow noreferrer">一条SQL查询语句是如何执行的？</a></b>，感兴趣的朋友可以阅读一下，我用其中的一张图展示查询操作需要经历的基本环节。</p><figure data-size="normal"><noscript><img src="https://picx.zhimg.com/50/v2-50bb1aa78ec2bcedc7d093b62dd599b9_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="1504" data-rawheight="1342" data-original-token="v2-17fb7e04b175e9d9b53125af1d561741" class="origin_image zh-lightbox-thumb" width="1504" data-original="https://pic1.zhimg.com/v2-50bb1aa78ec2bcedc7d093b62dd599b9_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1504&#39; height=&#39;1342&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1504" data-rawheight="1342" data-original-token="v2-17fb7e04b175e9d9b53125af1d561741" class="origin_image zh-lightbox-thumb lazy" width="1504" data-original="https://pic1.zhimg.com/v2-50bb1aa78ec2bcedc7d093b62dd599b9_r.jpg?source=2c26e567" data-actualsrc="https://picx.zhimg.com/50/v2-50bb1aa78ec2bcedc7d093b62dd599b9_720w.jpg?source=2c26e567"/><figcaption>SQL查询的环节</figcaption></figure><p data-pid="mHvJgYvQ">下面从5个角度介绍一下MySQL优化的一些策略。</p><figure data-size="normal"><noscript><img src="https://picx.zhimg.com/50/v2-881dc5bb38c8bd9a25544076c5fa269e_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="1528" data-rawheight="1420" data-original-token="v2-acd3fc93cfca35da863d86855f33751d" class="origin_image zh-lightbox-thumb" width="1528" data-original="https://picx.zhimg.com/v2-881dc5bb38c8bd9a25544076c5fa269e_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1528&#39; height=&#39;1420&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1528" data-rawheight="1420" data-original-token="v2-acd3fc93cfca35da863d86855f33751d" class="origin_image zh-lightbox-thumb lazy" width="1528" data-original="https://picx.zhimg.com/v2-881dc5bb38c8bd9a25544076c5fa269e_r.jpg?source=2c26e567" data-actualsrc="https://picx.zhimg.com/50/v2-881dc5bb38c8bd9a25544076c5fa269e_720w.jpg?source=2c26e567"/><figcaption>image-20220405204100602</figcaption></figure><h2><b>1. 连接配置优化</b></h2><p data-pid="yhqctuuq">处理连接是MySQL客户端和MySQL服务端亲热的第一步，第一步都迈不好，也就别谈后来的故事了。</p><p data-pid="du5xpc63">既然连接是双方的事情，我们自然从服务端和客户端两个方面来进行优化喽。</p><h3><b>1.1 服务端配置</b></h3><p data-pid="4GZ61Ij5">服务端需要做的就是尽可能地多接受客户端的连接，或许你遇到过<code>error 1040: Too many connections</code>的错误？就是服务端的胸怀不够宽广导致的，格局太小！</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/50/v2-9574dda1ed2e69b3bd56dabb3341ed5c_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="602" data-rawheight="642" data-original-token="v2-e6ed72d000f7f9eb0c52b669e3aa8b66" class="origin_image zh-lightbox-thumb" width="602" data-original="https://pica.zhimg.com/v2-9574dda1ed2e69b3bd56dabb3341ed5c_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;602&#39; height=&#39;642&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="602" data-rawheight="642" data-original-token="v2-e6ed72d000f7f9eb0c52b669e3aa8b66" class="origin_image zh-lightbox-thumb lazy" width="602" data-original="https://pica.zhimg.com/v2-9574dda1ed2e69b3bd56dabb3341ed5c_r.jpg?source=2c26e567" data-actualsrc="https://pic1.zhimg.com/50/v2-9574dda1ed2e69b3bd56dabb3341ed5c_720w.jpg?source=2c26e567"/><figcaption>感谢媳妇儿给画的图</figcaption></figure><p data-pid="Xt9QSwH6">我们可以从两个方面解决连接数不够的问题：</p><ol><li data-pid="YGu0plmk">增加可用连接数，修改环境变量<code>max_connections</code>，默认情况下服务端的最大连接数为<code>151</code>个</li></ol><div class="highlight"><pre><code class="language-text">mysql&gt; show variables like &#39;max_connections&#39;;
+-----------------+-------+
| Variable_name   | Value |
+-----------------+-------+
| max_connections | 151   |
+-----------------+-------+
1 row in set (0.01 sec)</code></pre></div><ol><li data-pid="la5cQSyi">及时释放不活动的连接，系统默认的客户端超时时间是28800秒（8小时），我们可以把这个值调小一点</li></ol><div class="highlight"><pre><code class="language-text">mysql&gt; show variables like &#39;wait_timeout&#39;;
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| wait_timeout  | 28800 |
+---------------+-------+
1 row in set (0.01 sec)</code></pre></div><blockquote data-pid="rA9554DE"> MySQL有非常多的配置参数，并且大部分参数都提供了默认值，默认值是MySQL作者经过精心设计的，完全可以满足大部分情况的需求，不建议在不清楚参数含义的情况下贸然修改。<br/> </blockquote><h3><b>1.2 客户端优化</b></h3><p data-pid="TlvOg5tP">客户端能做的就是尽量减少和服务端建立连接的次数，已经建立的连接能凑合用就凑合用，别每次执行个SQL语句都创建个新连接，服务端和客户端的资源都吃不消啊。</p><p data-pid="IKsLkt_c">解决的方案就是使用<b>连接池</b>来复用连接。</p><p data-pid="OhOlvvOU">常见的数据库连接池有<code>DBCP</code>、<code>C3P0</code>、阿里的<code>Druid</code>、<code>Hikari</code>，前两者用得很少了，后两者目前如日中天。</p><p data-pid="jXXwC5Vc">但是需要注意的是连接池并不是越大越好，比如<code>Druid</code>的默认最大连接池大小是8，<code>Hikari</code>默认最大连接池大小是10，盲目地加大连接池的大小，系统执行效率反而有可能降低。为什么？</p><p data-pid="SNm_JhLk">对于每一个连接，服务端会创建一个单独的线程去处理，连接数越多，服务端创建的线程自然也就越多。而线程数超过CPU个数的情况下，CPU势必要通过分配时间片的方式进行线程的上下文切换，频繁的上下文切换会造成很大的性能开销。</p><p data-pid="CxIuDcnN"><b><a href="https://link.zhihu.com/?target=https%3A//github.com/brettwooldridge/HikariCP/wiki/About-Pool-Sizing" class=" wrap external" target="_blank" rel="nofollow noreferrer">Hikari官方</a></b>给出了一个<code>PostgreSQL</code>数据库连接池大小的建议值公式，<code>CPU核心数*2+1</code>。假设服务器的CPU核心数是4，把连接池设置成9就可以了。这种公式在一定程度上对其他数据库也是适用的，大家面试的时候可以吹一吹。</p><h2><b>2. 架构优化</b></h2><h3><b>2.1 使用缓存</b></h3><p data-pid="qaWLiW_W">系统中难免会出现一些比较慢的查询，这些查询要么是数据量大，要么是查询复杂（关联的表多或者是计算复杂），使得查询会长时间占用连接。</p><p data-pid="a1nuzfif">如果这种数据的实效性不是特别强（不是每时每刻都会变化，例如每日报表），我们可以把此类数据放入缓存系统中，在数据的缓存有效期内，直接从缓存系统中获取数据，这样就可以减轻数据库的压力并提升查询效率。</p><figure data-size="normal"><noscript><img src="https://picx.zhimg.com/50/v2-b8c961c75169601cbbf77e5e5dc4332e_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="1064" data-rawheight="338" data-original-token="v2-ac037aa6e99a0f0bc79c0ca6318a2f5c" class="origin_image zh-lightbox-thumb" width="1064" data-original="https://picx.zhimg.com/v2-b8c961c75169601cbbf77e5e5dc4332e_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1064&#39; height=&#39;338&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1064" data-rawheight="338" data-original-token="v2-ac037aa6e99a0f0bc79c0ca6318a2f5c" class="origin_image zh-lightbox-thumb lazy" width="1064" data-original="https://picx.zhimg.com/v2-b8c961c75169601cbbf77e5e5dc4332e_r.jpg?source=2c26e567" data-actualsrc="https://picx.zhimg.com/50/v2-b8c961c75169601cbbf77e5e5dc4332e_720w.jpg?source=2c26e567"/><figcaption>缓存的使用</figcaption></figure><h3><b>2.2 读写分离（集群、主从复制）</b></h3><p data-pid="2tcrkjg8">项目的初期，数据库通常都是运行在一台服务器上的，用户的所有读写请求会直接作用到这台数据库服务器，单台服务器承担的并发量毕竟是有限的。</p><p data-pid="TG4tA2l9">针对这个问题，我们可以同时使用多台数据库服务器，将其中一台设置为为小组长，称之为<code>master</code>节点，其余节点作为组员，叫做<code>slave</code>。用户写数据只往<code>master</code>节点写，而读的请求分摊到各个<code>slave</code>节点上。这个方案叫做<b>读写分离</b>。给组长加上组员组成的小团体起个名字，叫<b>集群</b>。</p><figure data-size="normal"><noscript><img src="https://pica.zhimg.com/50/v2-578cf67d8b84abff29fed48081c50f08_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="708" data-rawheight="594" data-original-token="v2-187cfb9877d8e349dba34d34f66f8a5a" class="origin_image zh-lightbox-thumb" width="708" data-original="https://picx.zhimg.com/v2-578cf67d8b84abff29fed48081c50f08_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;708&#39; height=&#39;594&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="708" data-rawheight="594" data-original-token="v2-187cfb9877d8e349dba34d34f66f8a5a" class="origin_image zh-lightbox-thumb lazy" width="708" data-original="https://picx.zhimg.com/v2-578cf67d8b84abff29fed48081c50f08_r.jpg?source=2c26e567" data-actualsrc="https://pica.zhimg.com/50/v2-578cf67d8b84abff29fed48081c50f08_720w.jpg?source=2c26e567"/><figcaption>这就是集群</figcaption></figure><blockquote data-pid="GHdavawx"> 注：很多开发者不满<code>master-slave</code>这种具有侵犯性的词汇（因为他们认为会联想到种族歧视、黑人奴隶等），所以发起了一项更名运动。<br/> 受此影响MySQL也会逐渐停用<code>master</code>、<code>slave</code>等术语，转而用<code>source</code>和<code>replica</code>替代，大家碰到的时候明白即可。<br/> </blockquote><p data-pid="PJI_rRFp">使用集群必然面临一个问题，就是多个节点之间怎么保持数据的一致性。毕竟写请求只往<code>master</code>节点上发送了，只有<code>master</code>节点的数据是最新数据，怎么把对<code>master</code>节点的写操作也同步到各个<code>slave</code>节点上呢？</p><p data-pid="1pTBqdw5"><b>主从复制</b>技术来了！我在<b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI1MDU0MTc2MQ%3D%3D%26mid%3D2247484093%26idx%3D1%26sn%3Df0fb512d536701c3e0ecdbf330fd6f9d%26chksm%3De981e113def668058493e9102039b45034312946326fca9906744615b4547a364aa7bc445c16%26token%3D795558921%26lang%3Dzh_CN%23rd" class=" wrap external" target="_blank" rel="nofollow noreferrer">一条SQL更新语句是如何执行的？</a></b>中粗浅地介绍了一下binlog日志，我直接搬过来了。</p><p data-pid="mMxQRJyu"><code>binlog</code>是实现MySQL主从复制功能的核心组件。<code>master</code>节点会将所有的写操作记录到binlog中，<code>slave</code>节点会有专门的I/O线程读取<code>master</code>节点的binlog，将写操作同步到当前所在的<code>slave</code>节点。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/50/v2-d1c25d0e92f819f9de658ad8d0cc5cdb_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="1296" data-rawheight="914" data-original-token="v2-200ad4e57d468b23bd571158ff8b5b54" class="origin_image zh-lightbox-thumb" width="1296" data-original="https://pic1.zhimg.com/v2-d1c25d0e92f819f9de658ad8d0cc5cdb_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1296&#39; height=&#39;914&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1296" data-rawheight="914" data-original-token="v2-200ad4e57d468b23bd571158ff8b5b54" class="origin_image zh-lightbox-thumb lazy" width="1296" data-original="https://pic1.zhimg.com/v2-d1c25d0e92f819f9de658ad8d0cc5cdb_r.jpg?source=2c26e567" data-actualsrc="https://pic1.zhimg.com/50/v2-d1c25d0e92f819f9de658ad8d0cc5cdb_720w.jpg?source=2c26e567"/><figcaption>主从复制</figcaption></figure><p data-pid="nwhsNHU_">这种集群的架构对减轻主数据库服务器的压力有非常好的效果，但是随着业务数据越来越多，如果某张表的数据量急剧增加，单表的查询性能就会大幅下降，而这个问题是读写分离也无法解决的，毕竟所有节点存放的是一模一样的数据啊，单表查询性能差，说的自然也是所有节点性能都差。</p><p data-pid="Mtylf8yu">这时我们可以把单个节点的数据分散到多个节点上进行存储，这就是<b>分库分表</b>。</p><h3><b>2.3 分库分表</b></h3><p data-pid="l4v2NGla">分库分表中的节点的含义比较宽泛，要是把数据库作为节点，那就是分库；如果把单张表作为节点，那就是分表。</p><p data-pid="HAKCeMrA">大家都知道分库分表分成垂直分库、垂直分表、水平分库和水平分表，但是每次都记不住这些概念，我就给大家详细说一说，帮助大家理解。</p><h3><b>2.3.1 垂直分库</b></h3><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/50/v2-241fa8c1202b0d5881d460a290df4d17_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="912" data-rawheight="472" data-original-token="v2-583c0be9eb4361239a4c30ba69c4ada3" class="origin_image zh-lightbox-thumb" width="912" data-original="https://picx.zhimg.com/v2-241fa8c1202b0d5881d460a290df4d17_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;912&#39; height=&#39;472&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="912" data-rawheight="472" data-original-token="v2-583c0be9eb4361239a4c30ba69c4ada3" class="origin_image zh-lightbox-thumb lazy" width="912" data-original="https://picx.zhimg.com/v2-241fa8c1202b0d5881d460a290df4d17_r.jpg?source=2c26e567" data-actualsrc="https://pic1.zhimg.com/50/v2-241fa8c1202b0d5881d460a290df4d17_720w.jpg?source=2c26e567"/><figcaption>垂直分库</figcaption></figure><p data-pid="kZrkAkPp">在单体数据库的基础上垂直切几刀，按照业务逻辑拆分成不同的数据库，这就是<b>垂直分库</b>啦。</p><figure data-size="normal"><noscript><img src="https://picx.zhimg.com/50/v2-1174629a89b6ad4cf689c0ac6849ef93_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="1364" data-rawheight="648" data-original-token="v2-95f16f447bed5a8a6bfe0b29943af646" class="origin_image zh-lightbox-thumb" width="1364" data-original="https://picx.zhimg.com/v2-1174629a89b6ad4cf689c0ac6849ef93_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1364&#39; height=&#39;648&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1364" data-rawheight="648" data-original-token="v2-95f16f447bed5a8a6bfe0b29943af646" class="origin_image zh-lightbox-thumb lazy" width="1364" data-original="https://picx.zhimg.com/v2-1174629a89b6ad4cf689c0ac6849ef93_r.jpg?source=2c26e567" data-actualsrc="https://picx.zhimg.com/50/v2-1174629a89b6ad4cf689c0ac6849ef93_720w.jpg?source=2c26e567"/><figcaption>垂直分库</figcaption></figure><h3><b>2.3.2 垂直分表</b></h3><figure data-size="normal"><noscript><img src="https://picx.zhimg.com/50/v2-2354d22deaffe293a9f2a1ff613e0793_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="1122" data-rawheight="386" data-original-token="v2-ab6bb47c113fe2be555c5bd0acea9495" class="origin_image zh-lightbox-thumb" width="1122" data-original="https://pica.zhimg.com/v2-2354d22deaffe293a9f2a1ff613e0793_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1122&#39; height=&#39;386&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1122" data-rawheight="386" data-original-token="v2-ab6bb47c113fe2be555c5bd0acea9495" class="origin_image zh-lightbox-thumb lazy" width="1122" data-original="https://pica.zhimg.com/v2-2354d22deaffe293a9f2a1ff613e0793_r.jpg?source=2c26e567" data-actualsrc="https://picx.zhimg.com/50/v2-2354d22deaffe293a9f2a1ff613e0793_720w.jpg?source=2c26e567"/><figcaption>垂直分表</figcaption></figure><p data-pid="12dA7HSb">垂直分表就是在单表的基础上垂直切一刀（或几刀），将一个表的多个字短拆成若干个小表，这种操作需要根据具体业务来进行判断，通常会把经常使用的字段（热字段）分成一个表，不经常使用或者不立即使用的字段（冷字段）分成一个表，提升查询速度。</p><figure data-size="normal"><noscript><img src="https://pica.zhimg.com/50/v2-2112b867561f3d058cd8d687088a1a1c_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="1628" data-rawheight="700" data-original-token="v2-354eb5d602ce7bdadc31fb645615ada4" class="origin_image zh-lightbox-thumb" width="1628" data-original="https://pic1.zhimg.com/v2-2112b867561f3d058cd8d687088a1a1c_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1628&#39; height=&#39;700&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1628" data-rawheight="700" data-original-token="v2-354eb5d602ce7bdadc31fb645615ada4" class="origin_image zh-lightbox-thumb lazy" width="1628" data-original="https://pic1.zhimg.com/v2-2112b867561f3d058cd8d687088a1a1c_r.jpg?source=2c26e567" data-actualsrc="https://pica.zhimg.com/50/v2-2112b867561f3d058cd8d687088a1a1c_720w.jpg?source=2c26e567"/><figcaption>垂直分表</figcaption></figure><p data-pid="uWYPGacX">拿上图举例：通常情况下商品的详情信息都比较长，而且查看商品列表时往往不需要立即展示商品详情（一般都是点击详情按钮才会进行显示），而是会将商品更重要的信息（价格等）展示出来，按照这个业务逻辑，我们将原来的商品表做了垂直分表。</p><h3><b>2.3.3 水平分表</b></h3><p data-pid="MwiORkeC">把单张表的数据按照一定的规则（行话叫分片规则）保存到多个数据表上，横着给数据表来一刀（或几刀），就是<b>水平分表</b>了。</p><figure data-size="normal"><noscript><img src="https://picx.zhimg.com/50/v2-e429902adf5b2ab446adc1deb572d32a_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="1656" data-rawheight="552" data-original-token="v2-71ec31d9dd950044861972e0deb527c4" class="origin_image zh-lightbox-thumb" width="1656" data-original="https://pic1.zhimg.com/v2-e429902adf5b2ab446adc1deb572d32a_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1656&#39; height=&#39;552&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1656" data-rawheight="552" data-original-token="v2-71ec31d9dd950044861972e0deb527c4" class="origin_image zh-lightbox-thumb lazy" width="1656" data-original="https://pic1.zhimg.com/v2-e429902adf5b2ab446adc1deb572d32a_r.jpg?source=2c26e567" data-actualsrc="https://picx.zhimg.com/50/v2-e429902adf5b2ab446adc1deb572d32a_720w.jpg?source=2c26e567"/><figcaption>水平分表</figcaption></figure><figure data-size="normal"><noscript><img src="https://picx.zhimg.com/50/v2-a00410a431eb2b98cac29d0c21a40924_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="2060" data-rawheight="394" data-original-token="v2-f6d0c58c26791988c54bc56a79d7a012" class="origin_image zh-lightbox-thumb" width="2060" data-original="https://pica.zhimg.com/v2-a00410a431eb2b98cac29d0c21a40924_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;2060&#39; height=&#39;394&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="2060" data-rawheight="394" data-original-token="v2-f6d0c58c26791988c54bc56a79d7a012" class="origin_image zh-lightbox-thumb lazy" width="2060" data-original="https://pica.zhimg.com/v2-a00410a431eb2b98cac29d0c21a40924_r.jpg?source=2c26e567" data-actualsrc="https://picx.zhimg.com/50/v2-a00410a431eb2b98cac29d0c21a40924_720w.jpg?source=2c26e567"/><figcaption>水平分表</figcaption></figure><h3><b>2.3.4 水平分库</b></h3><p data-pid="K02-j7qz"><b>水平分库</b>就是对单个数据库水平切一刀，往往伴随着水平分表。</p><figure data-size="normal"><noscript><img src="https://picx.zhimg.com/50/v2-e6559d54b00b619425354c151a27011b_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="982" data-rawheight="380" data-original-token="v2-39e228049c38208faf77839f4afb3e86" class="origin_image zh-lightbox-thumb" width="982" data-original="https://pica.zhimg.com/v2-e6559d54b00b619425354c151a27011b_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;982&#39; height=&#39;380&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="982" data-rawheight="380" data-original-token="v2-39e228049c38208faf77839f4afb3e86" class="origin_image zh-lightbox-thumb lazy" width="982" data-original="https://pica.zhimg.com/v2-e6559d54b00b619425354c151a27011b_r.jpg?source=2c26e567" data-actualsrc="https://picx.zhimg.com/50/v2-e6559d54b00b619425354c151a27011b_720w.jpg?source=2c26e567"/><figcaption>水平分库</figcaption></figure><figure data-size="normal"><noscript><img src="https://picx.zhimg.com/50/v2-b8b7fe1f70ecd373f21507c13bf979bc_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="1390" data-rawheight="1008" data-original-token="v2-8dbb5a2acac5ec95ed39a4cf07be6c75" class="origin_image zh-lightbox-thumb" width="1390" data-original="https://picx.zhimg.com/v2-b8b7fe1f70ecd373f21507c13bf979bc_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1390&#39; height=&#39;1008&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1390" data-rawheight="1008" data-original-token="v2-8dbb5a2acac5ec95ed39a4cf07be6c75" class="origin_image zh-lightbox-thumb lazy" width="1390" data-original="https://picx.zhimg.com/v2-b8b7fe1f70ecd373f21507c13bf979bc_r.jpg?source=2c26e567" data-actualsrc="https://picx.zhimg.com/50/v2-b8b7fe1f70ecd373f21507c13bf979bc_720w.jpg?source=2c26e567"/><figcaption>水平分库</figcaption></figure><h3><b>2.3.5 总结</b></h3><p data-pid="D_6eyOPn"><b>水平分，主要是为了解决存储的瓶颈；垂直分，主要是为了减轻并发压力。</b></p><h3><b>2.4 消息队列削峰</b></h3><p data-pid="lVm58i1O">通常情况下，用户的请求会直接访问数据库，如果同一时刻在线用户数量非常庞大，极有可能压垮数据库（参考明星出轨或公布恋情时微博的状态）。</p><p data-pid="bmq37pH2">这种情况下可以通过使用消息队列降低数据库的压力，不管同时有多少个用户请求，先存入消息队列，然后系统有条不紊地从消息队列中消费请求。</p><figure data-size="normal"><noscript><img src="https://pica.zhimg.com/50/v2-833db19f5fb348278a4f3b4b38932895_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="814" data-rawheight="798" data-original-token="v2-603c11f9f729a1080dddb05a4aed9f90" class="origin_image zh-lightbox-thumb" width="814" data-original="https://picx.zhimg.com/v2-833db19f5fb348278a4f3b4b38932895_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;814&#39; height=&#39;798&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="814" data-rawheight="798" data-original-token="v2-603c11f9f729a1080dddb05a4aed9f90" class="origin_image zh-lightbox-thumb lazy" width="814" data-original="https://picx.zhimg.com/v2-833db19f5fb348278a4f3b4b38932895_r.jpg?source=2c26e567" data-actualsrc="https://pica.zhimg.com/50/v2-833db19f5fb348278a4f3b4b38932895_720w.jpg?source=2c26e567"/><figcaption>队列削峰</figcaption></figure><h2><b>3. 优化器——SQL分析与优化</b></h2><p data-pid="STOJ6mbR">处理完连接、优化完缓存等架构的事情，SQL查询语句来到了解析器和优化器的地盘了。在这一步如果出了任何问题，那就只能是SQL语句的问题了。</p><p data-pid="_Ooj9oKn">只要你的语法不出问题，解析器就不会有问题。此外，为了防止你写的SQL运行效率低，优化器会自动做一些优化，但如果实在是太烂，优化器也救不了你了，只能眼睁睁地看着你的SQL查询沦为<b>慢查询</b>。</p><h3><b>3.1 慢查询</b></h3><p data-pid="SeTAdpYs"><b>慢查询</b>就是执行地很慢的查询（这句话说得跟废话似的。。。），只有知道MySQL中有哪些慢查询我们才能针对性地进行优化。</p><p data-pid="pTSEBZMS">因为开启慢查询日志是有性能代价的，因此MySQL默认是关闭慢查询日志功能，使用以下命令查看当前慢查询状态</p><div class="highlight"><pre><code class="language-text">mysql&gt; show variables like &#39;slow_query%&#39;;
+---------------------+--------------------------------------+
| Variable_name       | Value                                |
+---------------------+--------------------------------------+
| slow_query_log      | OFF                                  |
| slow_query_log_file | /var/lib/mysql/9e74f9251f6c-slow.log |
+---------------------+--------------------------------------+
2 rows in set (0.00 sec)</code></pre></div><p data-pid="v6JI39Cs"><code>slow_query_log</code>表示当前慢查询日志是否开启，<code>slow_query_log_file</code>表示慢查询日志的保存位置。</p><p data-pid="8iQiamDr">除了上面两个变量，我们还需要确定“慢”的指标是什么，即执行超过多长时间才算是慢查询，默认是<code>10S</code>，如果改成<code>0</code>的话就是记录所有的SQL。</p><div class="highlight"><pre><code class="language-text">mysql&gt; show variables like &#39;%long_query%&#39;;
+-----------------+-----------+
| Variable_name   | Value     |
+-----------------+-----------+
| long_query_time | 10.000000 |
+-----------------+-----------+
1 row in set (0.00 sec)</code></pre></div><h3><b>3.1.1 打开慢日志</b></h3><p data-pid="khQbE6rG">有两种打开慢日志的方式</p><ol><li data-pid="-wjUnDSQ">修改配置文件<code>my.cnf</code></li></ol><p data-pid="eIoMggk9">此种修改方式系统重启后依然有效</p><div class="highlight"><pre><code class="language-text"># 是否开启慢查询日志
slow_query_log=ON
# 
long_query_time=2
slow_query_log_file=/var/lib/mysql/slow.log
</code></pre></div><ol><li data-pid="Eii8ttQF">动态修改参数（重启后失效）</li></ol><div class="highlight"><pre><code class="language-text">mysql&gt; set @@global.slow_query_log=1;
Query OK, 0 rows affected (0.06 sec)

mysql&gt; set @@global.long_query_time=2;
Query OK, 0 rows affected (0.00 sec)</code></pre></div><h3><b>3.1.2 慢日志分析</b></h3><p data-pid="Av6sQct3">MySQL不仅为我们保存了慢日志文件，还为我们提供了慢日志查询的工具<code>mysqldumpslow</code>，为了演示这个工具，我们先构造一条慢查询：</p><div class="highlight"><pre><code class="language-text">mysql&gt; SELECT sleep(5);</code></pre></div><p data-pid="e7GeUahD">然后我们查询用时最多的1条慢查询：</p><div class="highlight"><pre><code class="language-text">[root@iZ2zejfuakcnnq2pgqyzowZ ~]# mysqldumpslow -s t -t 1 -g &#39;select&#39; /var/lib/mysql/9e74f9251f6c-slow.log

Reading mysql slow query log from /var/lib/mysql/9e74f9251f6c-slow.log
Count: 1  Time=10.00s (10s)  Lock=0.00s (0s)  Rows=1.0 (1), root[root]@localhost
  SELECT sleep(N)
</code></pre></div><p data-pid="mX4JS1DP">其中，</p><ul><li data-pid="3pPBn-PK"><b>Count</b>：表示这个SQL执行的次数</li><li data-pid="iEtmpTHA"><b>Time</b>：表示执行的时间，括号中的是累积时间</li><li data-pid="8XDgff5_"><b>Locks</b>：表示锁定的时间，括号中的是累积时间</li><li data-pid="YV_s5K6x"><b>Rows</b>：表示返回的记录数，括号中的是累积数</li></ul><p data-pid="o0xoc2s7">更多关于<code>mysqldumpslow</code>的使用方式，可以查阅官方文档，或者执行<code>mysqldumpslow --help</code>寻求帮助。</p><h3><b>3.2 查看运行中的线程</b></h3><p data-pid="pzDt9iNm">我们可以运行<code>show full processlist</code>查看MySQL中运行的所有线程，查看其状态和运行时间，找到不顺眼的，直接kill。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/50/v2-7d33d6083900479e45a778e04f14f014_720w.jpg?source=2c26e567" data-size="normal" data-rawwidth="2124" data-rawheight="446" data-original-token="v2-6ca06258e399429b3bda093fd44c9a0b" class="origin_image zh-lightbox-thumb" width="2124" data-original="https://pic1.zhimg.com/v2-7d33d6083900479e45a778e04f14f014_r.jpg?source=2c26e567"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;2124&#39; height=&#39;446&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="2124" data-rawheight="446" data-original-token="v2-6ca06258e399429b3bda093fd44c9a0b" class="origin_image zh-lightbox-thumb lazy" width="2124" data-original="https://pic1.zhimg.com/v2-7d33d6083900479e45a778e04f14f014_r.jpg?source=2c26e567" data-actualsrc="https://pic1.zhimg.com/50/v2-7d33d6083900479e45a778e04f14f014_720w.jpg?source=2c26e567"/><figcaption>image-20220405182328247</figcaption></figure><p data-pid="-JAUDhvp">其中，</p><ul><li data-pid="iZ7EYlvR"><b>Id</b>：线程的唯一标志，可以使用Id杀死指定线程</li><li data-pid="Q6JrOCsk"><b>User</b>：启动这个线程的用户，普通账户只能查看自己的线程</li><li data-pid="UXGWexKa"><b>Host</b>：哪个ip和端口发起的连接</li><li data-pid="eyM-Emv6"><b>db</b>：线程操作的数据库</li><li data-pid="XMFsWIMm"><b>Command</b>：线程的命令</li><li data-pid="J2eIXdgV"><b>Time</b>：操作持续时间，单位秒</li><li data-pid="bmlr_5_p"><b>State</b>：线程的状态</li><li data-pid="gxCkjWQY"><b>Info</b>：SQL语句的前100个字符</li></ul><h3><b>3.3 查看服务器运行状态</b></h3><p data-pid="P4fgOKg-">使用<code>SHOW STATUS</code>查看MySQL服务器的运行状态，有<code>session</code>和<code>global</code>两种作用域，一般使用<code>like+通配符</code>进行过滤。</p><div class="highlight"><pre><code class="language-text">-- 查看select的次数
mysql&gt; SHOW GLOBAL STATUS LIKE &#39;com_select&#39;;
+---------------+--------+
| Variable_name | Value  |
+---------------+--------+
| Com_select    | 168241 |
+---------------+--------+
1 row in set (0.05 sec)</code></pre></div><h3><b>3.4 查看存储引擎运行信息</b></h3><p data-pid="Zg9EYjtG"><code>SHOW ENGINE</code>用来展示存储引擎的当前运行信息，包括事务持有的表锁、行锁信息；事务的锁等待情况；线程信号量等待；文件IO请求；Buffer pool统计信息等等数据。</p><p data-pid="Iv7ykxVS">例如：</p><div class="highlight"><pre><code class="language-text">SHOW ENGINE INNODB STATUS;</code></pre></div><p data-pid="D2IGOy1a">上面这条语句可以展示innodb存储引擎的当前运行的各种信息，大家可以据此找到MySQL当前的问题，限于篇幅不在此意义说明其中信息的含义，大家只要知道MySQL提供了这样一个监控工具就行了，等到需要的时候再来用就好。</p><h3><b>3.5 EXPLAIN执行计划</b></h3><p data-pid="Jm-as6eU">通过慢查询日志我们可以知道哪些SQL语句执行慢了，可是为什么慢？慢在哪里呢？</p><p data-pid="4Y8BEuuy">MySQL提供了一个执行计划的查询命令<code>EXPLAIN</code>，通过此命令我们可以查看SQL执行的计划，所谓执行计划就是：优化器会不会优化我们自己书写的SQL语句（比如外连接改内连接查询，子查询优化为连接查询...）、优化器针对此条SQL的执行对哪些索引进行了成本估算，并最终决定采用哪个索引（或者最终选择不用索引，而是全表扫描）、优化器对单表执行的策略是什么，等等等等。</p><blockquote data-pid="tN0cWLEs"> EXPLAIN在MySQL5.6.3之后也可以针对UPDATE、DELETE和INSERT语句进行分析，但是通常情况下我们还是用在SELECT查询上。<br/> </blockquote><p data-pid="R4xiqmFq">这篇文章主要是从宏观上多个角度介绍MySQL的优化策略，因此这里不详细说明<code>EXPLAIN</code>的细节，之后单独成篇。</p><h3><b>3.6 SQL与索引优化</b></h3><h3><b>3.6.1 SQL优化</b></h3><p data-pid="UJzJRUZY">SQL优化指的是SQL本身语法没有问题，但是有实现相同目的的更好的写法。比如：</p><ul><li data-pid="sbII9dyN">使用小表驱动大表；用join改写子查询；or改成union</li><li data-pid="xdD0jmuv">连接查询中，尽量减少驱动表的扇出（记录数），访问被驱动表的成本要尽量低，尽量在被驱动表的连接列上建立索引，降低访问成本；被驱动表的连接列最好是该表的主键或者是唯一二级索引列，这样被驱动表的成本会降到更低</li><li data-pid="WhxsX1SB">大偏移量的limit，先过滤再排序</li></ul><p data-pid="rBGX3MAV">针对最后一条举个简单的例子，下面两条语句能实现同样的目的，但是第二条的执行效率比第一条执行效率要高得多（存储引擎使用的是InnoDB），大家感受一下：</p><div class="highlight"><pre><code class="language-text">-- 1. 大偏移量的查询
mysql&gt; SELECT * FROM user_innodb LIMIT 9000000,10;
Empty set (8.18 sec)

-- 2.先过滤ID（因为ID使用的是索引），再limit
mysql&gt; SELECT * FROM user_innodb WHERE id &gt; 9000000 LIMIT 10;
Empty set (0.02 sec)</code></pre></div><h3><b>3.6.2 索引优化</b></h3><p data-pid="3XQ1d35F">为慢查询创建适当的索引是个非常常见并且非常有效的方法，但是索引是否会被高效使用又是另一门学问了。</p><p data-pid="7ifqvF_C">我之前写过一篇<b><a href="https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzI1MDU0MTc2MQ%3D%3D%26mid%3D2247484338%26idx%3D1%26sn%3Df753421c70f0e436c040af9e969c3331%26chksm%3De981e01cdef6690ae6e4bec7c92b436019f5f30e02f35524ca8e144a92b8aa743fc2c51d2c27%26token%3D1056536482%26lang%3Dzh_CN%23rd" class=" wrap external" target="_blank" rel="nofollow noreferrer">用好MySQL索引，你必须知道的一些事情 </a></b>，感兴趣的读者可以看一下。</p><h2><b>4. 存储引擎与表结构</b></h2><h3><b>4.1 选择存储引擎</b></h3><p data-pid="x3ZKlh2_">一般情况下，我们会选择MySQL默认的存储引擎存储引擎<code>InnoDB</code>，但是当对数据库性能要求精益求精的时候，存储引擎的选择也成为一个关键的影响因素。</p><p data-pid="KN788VBF">建议根据不同的业务选择不同的存储引擎，例如：</p><ul><li data-pid="gGdUNAA8">查询操作、插入操作多的业务表，推荐使用<code>MyISAM</code>；</li><li data-pid="SA8AEwcp">临时表使用<code>Memory</code>；</li><li data-pid="sGx8yHM7">并发数量大、更新多的业务选择使用<code>InnoDB</code>；</li><li data-pid="p7p17rmb">不知道选啥直接默认。</li></ul><h3><b>4.2 优化字段</b></h3><p data-pid="Rg7Pc5Sp">字段优化的最终原则是：<b>使用可以正确存储数据的最小的数据类型</b>。</p><h3><b>4.2.1 整数类型</b></h3><p data-pid="4-CaBYHn">MySQL提供了6种整数类型，分别是</p><ul><li data-pid="jAQ_9rdV"><b>tinyint</b></li><li data-pid="lVbmpBzo"><b>smallint</b></li><li data-pid="R2Kkcnnk"><b>mediumint</b></li><li data-pid="Oeu715AK"><b>int</b></li><li data-pid="4yo5i2Yh"><b>integer</b></li><li data-pid="JLn_NAJQ"><b>bigint</b></li></ul><p data-pid="Xh46gXlp">不同的存储类型的最大存储范围不同，占用的存储的空间自然也不同。</p><p data-pid="udEbsv_a">例如，是否被删除的标识，建议选用<code>tinyint</code>，而不是<code>bigint</code>。</p><h3><b>4.2.2 字符类型</b></h3><p data-pid="Uu9aoNfO">你是不是直接把所有字符串的字段都设置为<code>varchar</code>格式了？甚至怕不够，还会直接设置成<code>varchar(1024)</code>的长度？</p><p data-pid="6ooXZFsP">如果不确定字段的长度，肯定是要选择<code>varchar</code>，但是<code>varchar</code>需要额外的空间来记录该字段目前占用的长度；因此如果字段的长度是固定的，尽量选用<code>char</code>，这会给你节约不少的内存空间。</p><h3><b>4.2.3 非空</b></h3><p data-pid="EquC9qvx">非空字段尽量设置成<code>NOT NULL</code>，并提供默认值，或者使用特殊值代替<code>NULL</code>。</p><p data-pid="WJ1yD-WY">因为<code>NULL</code>类型的存储和优化都会存在性能不佳的问题，具体原因在这里就不展开了。</p><h3><b>4.2.4 不要用外键、触发器和视图功能</b></h3><p data-pid="vFZmGCB_">这也是「阿里巴巴开发手册」中提到的原则。原因有三个：</p><ol><li data-pid="r0tzF_0s">降低了可读性，检查代码的同时还得查看数据库的代码；</li><li data-pid="WvGTXAM5">把计算的工作交给程序，数据库只做好存储的工作，并把这件事情做好；</li><li data-pid="EIfRZEYR">数据的完整性校验的工作应该由开发者完成，而不是依赖于外键，一旦用了外键，你会发现测试的时候随便删点垃圾数据都变得异常艰难。</li></ol><h3><b>4.2.5 图片、音频、视频存储</b></h3><p data-pid="W0AGPKc2">不要直接存储大文件，而是要存储大文件的访问地址。</p><h3><b>4.2.6 大字段拆分和数据冗余</b></h3><p data-pid="utlW0HSg"><b>大字段拆分</b>其实就是前面说过的垂直分表，把不常用的字段或者数据量较大的字段拆分出去，避免列数过多和数据量过大，尤其是习惯编写<code>SELECT *</code>的情况下，列数多和数据量大导致的问题会被严重放大！</p><p data-pid="DiCktwrm"><b>字段冗余</b>原则上不符合数据库设计范式，但是却非常有利于快速检索。比如，合同表中存储客户id的同时可以冗余存储客户姓名，这样查询时就不需要再根据客户id获取用户姓名了。因此针对业务逻辑适当做一定程度的冗余也是一种比较好的优化技巧。</p><h2><b>5. 业务优化</b></h2><p data-pid="d1acSoQn">严格来说，业务方面的优化已经不算是MySQL调优的手段了，但是业务的优化却能非常有效地减轻数据库访问压力，这方面一个典型例子就是淘宝，下面举几个简单例子给大家提供一下思路：</p><ol><li data-pid="6sUjs2kn">以往都是双11当晚开始买买买的模式，最近几年双11的预售战线越拉越长，提前半个多月就开始了，而且各种定金红包模式丛出不穷，这种方式叫做<b>预售分流</b>。这样做可以分流客户的服务请求，不必等到双十一的凌晨一股脑地集体下单；</li><li data-pid="MYqR_U2N">双十一的凌晨你或许想查询当天之外的订单，但是却查询失败；甚至支付宝里的小鸡的口粮都被延迟发放了，这是一种<b>降级策略</b>，集结不重要的服务的计算资源，用来保证当前最核心的业务；</li><li data-pid="xPmr6tx1">双十一的时候支付宝极力推荐使用花呗支付，而不是银行卡支付，虽然一部分考量是提高软件粘性，但是另一方面，使用余额宝实际使用的阿里内部服务器，访问速度快，而使用银行卡，需要调用银行接口，相比之下操作要慢了许多。</li></ol><hr/><p data-pid="CZ2Baeox">MySQL优化的总结写到此就结束了，其中有不少细节没有提及，多少让我感觉这篇文章不完美。但是有些知识点掰开讲又太多了，不可能一下子全部写下，之后再好好写吧。</p><p data-pid="HmQKlcrU">我是蝉沐风，公众号「蝉沐风」，一个认真写文章的技术人，下期见！</p></span></div></div></span><div><div class="ContentItem-time"><a target="_blank" href="//www.zhihu.com/question/486575193/answer/2425182871"><span data-tooltip="发布于 2022-04-06 07:54" aria-label="发布于 2022-04-06 07:54">发布于 2022-04-06 07:54</span></a></div></div><span></span><div class="ContentItem-actions RichContent-actions"><span><button aria-label="赞同 66 " aria-live="polite" type="button" class="Button VoteButton VoteButton--up FEfUrdfMIKpQDJDqkjte"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor"><path fill-rule="evenodd" d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023Z" clip-rule="evenodd"></path></svg></span>赞同 66</button><button aria-label="反对" aria-live="polite" type="button" class="Button VoteButton VoteButton--down FEfUrdfMIKpQDJDqkjte"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleDown" fill="currentColor"><path fill-rule="evenodd" d="M13.792 20.319c-.781 1.406-2.803 1.406-3.584 0L2.418 6.296c-.76-1.367.228-3.046 1.791-3.046h15.582c1.563 0 2.55 1.68 1.791 3.046l-7.79 14.023Z" clip-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Comment Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>5 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Share Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M19.47 1.914a.8.8 0 0 1 1.204.778l-1.872 16.386a.9.9 0 0 1-1.204.743l-4.615-1.692a.7.7 0 0 0-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 0 1 .179-.504l5.808-7.148a.595.595 0 0 0-.897-.781l-5.93 6.354a1.1 1.1 0 0 1-1.258.252L2.57 13.46a.8.8 0 0 1-.08-1.415l16.98-10.13Z"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Star Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M10.484 3.307c.673-1.168 2.358-1.168 3.032 0l2.377 4.122a.25.25 0 0 0 .165.12l4.655.987c1.319.28 1.84 1.882.937 2.884l-3.186 3.535a.25.25 0 0 0-.063.193l.5 4.733c.142 1.34-1.222 2.33-2.453 1.782l-4.346-1.938a.25.25 0 0 0-.204 0l-4.346 1.938c-1.231.549-2.595-.442-2.453-1.782l.5-4.733a.25.25 0 0 0-.064-.193L2.35 11.42c-.903-1.002-.382-2.604.937-2.884l4.655-.987a.25.25 0 0 0 .164-.12l2.378-4.122Z"></path></svg></span>收藏</button><button aria-live="polite" type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Heart Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button><button data-zop-retract-question="true" type="button" class="Button ContentItem-action ContentItem-rightButton FEfUrdfMIKpQDJDqkjte Button--plain fEPKGkUK5jyc4fUuT0QP"><span class="RichContent-collapsedText">收起</span><span style="display:inline-flex;align-items:center">​<svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--ArrowDown ContentItem-arrowIcon is-active" fill="currentColor"><path fill-rule="evenodd" d="M17.776 10.517a.875.875 0 0 1-.248 1.212l-5.05 3.335a.875.875 0 0 1-.964 0L6.47 11.73a.875.875 0 1 1 .965-1.46l4.56 3.015 4.568-3.016a.875.875 0 0 1 1.212.248Z" clip-rule="evenodd"></path></svg></span></button></div></div><div><div><div class=""></div><div class="ModalLoading-content"><style data-emotion-css="1od72gz animation-js282a animation-18pxbu9">.css-1od72gz{position:absolute;top:50%;left:50%;margin:-15px 0 0 -15px;-webkit-animation:animation-18pxbu9 1s linear infinite;animation:animation-18pxbu9 1s linear infinite;}.css-1od72gz .path{stroke:#1772F6;stroke-dasharray:187;stroke-dashoffset:0;-webkit-transform-origin:center;-ms-transform-origin:center;transform-origin:center;-webkit-animation:animation-js282a 1s ease-in-out infinite;animation:animation-js282a 1s ease-in-out infinite;}@-webkit-keyframes animation-js282a{0%{stroke-dashoffset:187;}50%{stroke-dashoffset:46.75;-webkit-transform:rotate(135deg);-ms-transform:rotate(135deg);transform:rotate(135deg);}100%{stroke-dashoffset:187;-webkit-transform:rotate(450deg);-ms-transform:rotate(450deg);transform:rotate(450deg);}}@keyframes animation-js282a{0%{stroke-dashoffset:187;}50%{stroke-dashoffset:46.75;-webkit-transform:rotate(135deg);-ms-transform:rotate(135deg);transform:rotate(135deg);}100%{stroke-dashoffset:187;-webkit-transform:rotate(450deg);-ms-transform:rotate(450deg);transform:rotate(450deg);}}@-webkit-keyframes animation-18pxbu9{0%{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}100%{-webkit-transform:rotate(270deg);-ms-transform:rotate(270deg);transform:rotate(270deg);}}@keyframes animation-18pxbu9{0%{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}100%{-webkit-transform:rotate(270deg);-ms-transform:rotate(270deg);transform:rotate(270deg);}}</style><svg width="30" height="30" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg" class="CircleLoadingBar  css-1od72gz" aria-hidden="true"><g><circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></g></svg></div></div></div></div></div></div></div><div class="Card ViewAll"><a href="/question/486575193" class="QuestionMainAction ViewAll-QuestionMainAction" data-za-detail-view-element_name="ViewAll">查看全部 42 个回答</a></div></div></div></div></div></div></main><div data-zop-usertoken="{}"></div></div></div><script id="js-clientConfig" type="text/json">{"fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","lens":"https:\u002F\u002Flens.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fapi\u002F","walletpay":"https:\u002F\u002Fwalletpay.zhihu.com","captcha":"https:\u002F\u002Fcaptcha.zhihu.com","vzuu":"https:\u002F\u002Fv.vzuu.com","openapi":"https:\u002F\u002Fopenapi.zhihu.com","svip":"https:\u002F\u002Fsvip.zhihu.com"},"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","videoHost":"video.zhihu.com","zhuanlanHost":"zhuanlan.zhihu.com","allowSignUp":true,"refreshValidityPeriod":"30","release":"1187-6162a094","currentEntry":"main","isMobileEntry":false,"apollo":{"env":"prod","globalSilence":"","ncgModeSign":"3f8e56febda4fb3bbea72e379d76de1e","topstory_rec_adp":"1","topstory_hot_adp":"1","editor_adapt_native":"0","enable_request_filter":"1","content_publish_pin":"0","content_publish_answer":"1","content_publish_question":"0","content_publish_article":"1","content_publish_zvideo":"1","balanceModalSign":"ChYHAcB5ihJECkAFnhDAYmdhsTWVJoNc","test_canary":"member|0-100,1-0","use_new_player":"member|0-100,1-0","player_vendor":"member|0-100,1-0,2-0","use_hevc":"member|0-0,1-100","upload_use_signature":"member|0-0,1-100","use_backdrop_blur":"member|0-0,1-100","article_title_imagex":"member|0-0,1-100","play_station":"member|0-0,1-100","use_cached_supported_countries":"device|1-100,0-0","contentItem_cover_imagex":"member|0-0,1-100","use_qrcode_login_v2":"device|1-100,0-0"}}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{},"cities":{"cityData":[]}},"loading":{"global":{"count":0},"local":{"question\u002Fget\u002F":false,"answer\u002Fget\u002F":false}},"entities":{"users":{},"questions":{"486575193":{"type":"question","id":486575193,"title":"mysql 优化方法有哪些？","questionType":"normal","created":1631518921,"updatedTime":1631518921,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F486575193","isMuted":false,"isVisible":true,"isNormal":true,"isEditable":false,"adminClosedComment":false,"hasPublishingDraft":false,"answerCount":42,"visitCount":138059,"commentCount":0,"followerCount":367,"collapsedAnswerCount":0,"excerpt":"","commentPermission":"all","detail":"","editableDetail":"","status":{"isLocked":false,"isClose":false,"isEvaluate":false,"isSuggest":false},"relationship":{"isAuthor":false,"isFollowing":false,"isAnonymous":false,"canLock":false,"canStickAnswers":false,"canCollapseAnswers":false,"voting":0},"topics":[{"id":"19552067","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19552067","name":"数据库","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b0da2c02b5cf330263a3c328bf40e7f0_qhd.jpg?source=57bbeac9","topicType":"NORMAL"},{"id":"19552079","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19552079","name":"面试","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-096b5e9a6beb5b87e65868704865543e_qhd.jpg?source=57bbeac9","topicType":"NORMAL"},{"id":"19554128","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19554128","name":"MySQL","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-572f15f475fdbfa9b6b34344a8535c3d_qhd.jpg?source=57bbeac9","topicType":"NORMAL"},{"id":"19667043","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19667043","name":"MySQL 入门","avatarUrl":"","topicType":"NORMAL"},{"id":"20075899","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F20075899","name":"MySQL DBA","avatarUrl":"","topicType":"NORMAL"}],"author":{"id":"0","urlToken":"","name":"匿名用户","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-d41c2ceaed8f51999522f903672a521f_l.jpg?source=1def8aca","avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-d41c2ceaed8f51999522f903672a521f.jpg?source=1def8aca","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F0","userType":"people","headline":"","badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"gender":1,"isAdvertiser":false,"followerCount":0,"isFollowing":false,"isFollowed":false,"isCelebrity":false,"isBlocking":false,"isBlocked":false,"isPrivacy":false},"canComment":{"status":true,"reason":""},"thumbnailInfo":{"count":0,"type":"thumbnail_info","thumbnails":[]},"reviewInfo":{"type":"","tips":"","editTips":"","isReviewing":false,"editIsReviewing":false},"relatedCards":[],"muteInfo":{"type":""},"showAuthor":false,"isLabeled":false,"isBannered":false,"showEncourageAuthor":false,"voteupCount":4,"canVote":true,"reactionInstruction":{}}},"answers":{"2425182871":{"adminClosedComment":false,"annotationAction":null,"answerType":"normal","author":{"avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002F03ee281e7d4710596689e547f345f53a_l.jpg?source=2c26e567","avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002F03ee281e7d4710596689e547f345f53a.jpg?source=2c26e567","badge":[{"description":"山东大学 管理学硕士在读","topics":[],"type":"identity"}],"badgeV2":{"detailBadges":[{"description":"山东大学 管理学硕士在读","detailType":"identity_people","icon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","sources":[],"title":"已认证的个人","type":"identity","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F96956163"}],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","mergedBadges":[{"description":"山东大学 管理学硕士在读","detailType":"identity","icon":"","nightIcon":"","sources":[],"title":"认证","type":"identity","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F96956163"}],"nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-2ddc5cc683982648f6f123616fb4ec09_l.png?source=32738c0c","title":"山东大学 管理学硕士在读"},"gender":1,"headline":"公众号「蝉沐风的码场」主理人","id":"6eba1fab73779fca46a113a9932b8021","isAdvertiser":false,"isFollowed":false,"isOrg":false,"isPrivacy":false,"name":"蝉沐风","type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F6eba1fab73779fca46a113a9932b8021","urlToken":"chanmufeng","userType":"people"},"bizExt":{},"canComment":{"reason":"","status":true},"collapseReason":"","collapsedBy":"nobody","commentCount":5,"commentPermission":"all","content":"\u003Cp data-pid=\"FxU_EVgy\"\u003E面试官如果问你：你会从哪些维度进行MySQL性能优化？你会怎么回答？\u003C\u002Fp\u003E\u003Cp data-pid=\"RBXvF_MI\"\u003E所谓的性能优化，一般针对的是MySQL查询的优化。既然是优化查询，我们自然要先知道查询操作要经过哪些环节，然后思考可以在哪些环节进行优化。\u003C\u002Fp\u003E\u003Cp data-pid=\"7Xa2jH66\"\u003E我之前写过\u003Cb\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fmp.weixin.qq.com\u002Fs%3F__biz%3DMzI1MDU0MTc2MQ%3D%3D%26mid%3D2247484069%26idx%3D1%26sn%3Dd40d90ab9e3041757262be5192a46e9e%26chksm%3De981e10bdef6681dde2ede9c1293e4b379fb827ab3c7d64ae828311c4ee14e19e20d7537d5f0%23rd\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E一条SQL查询语句是如何执行的？\u003C\u002Fa\u003E\u003C\u002Fb\u003E，感兴趣的朋友可以阅读一下，我用其中的一张图展示查询操作需要经历的基本环节。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-50bb1aa78ec2bcedc7d093b62dd599b9_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"1504\" data-rawheight=\"1342\" data-original-token=\"v2-17fb7e04b175e9d9b53125af1d561741\" class=\"origin_image zh-lightbox-thumb\" width=\"1504\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-50bb1aa78ec2bcedc7d093b62dd599b9_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1504&#39; height=&#39;1342&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1504\" data-rawheight=\"1342\" data-original-token=\"v2-17fb7e04b175e9d9b53125af1d561741\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1504\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-50bb1aa78ec2bcedc7d093b62dd599b9_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-50bb1aa78ec2bcedc7d093b62dd599b9_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003ESQL查询的环节\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"mHvJgYvQ\"\u003E下面从5个角度介绍一下MySQL优化的一些策略。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-881dc5bb38c8bd9a25544076c5fa269e_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"1528\" data-rawheight=\"1420\" data-original-token=\"v2-acd3fc93cfca35da863d86855f33751d\" class=\"origin_image zh-lightbox-thumb\" width=\"1528\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-881dc5bb38c8bd9a25544076c5fa269e_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1528&#39; height=&#39;1420&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1528\" data-rawheight=\"1420\" data-original-token=\"v2-acd3fc93cfca35da863d86855f33751d\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1528\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-881dc5bb38c8bd9a25544076c5fa269e_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-881dc5bb38c8bd9a25544076c5fa269e_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003Eimage-20220405204100602\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch2\u003E\u003Cb\u003E1. 连接配置优化\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp data-pid=\"yhqctuuq\"\u003E处理连接是MySQL客户端和MySQL服务端亲热的第一步，第一步都迈不好，也就别谈后来的故事了。\u003C\u002Fp\u003E\u003Cp data-pid=\"du5xpc63\"\u003E既然连接是双方的事情，我们自然从服务端和客户端两个方面来进行优化喽。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E1.1 服务端配置\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"4GZ61Ij5\"\u003E服务端需要做的就是尽可能地多接受客户端的连接，或许你遇到过\u003Ccode\u003Eerror 1040: Too many connections\u003C\u002Fcode\u003E的错误？就是服务端的胸怀不够宽广导致的，格局太小！\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002F50\u002Fv2-9574dda1ed2e69b3bd56dabb3341ed5c_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"602\" data-rawheight=\"642\" data-original-token=\"v2-e6ed72d000f7f9eb0c52b669e3aa8b66\" class=\"origin_image zh-lightbox-thumb\" width=\"602\" data-original=\"https:\u002F\u002Fpica.zhimg.com\u002Fv2-9574dda1ed2e69b3bd56dabb3341ed5c_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;602&#39; height=&#39;642&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"602\" data-rawheight=\"642\" data-original-token=\"v2-e6ed72d000f7f9eb0c52b669e3aa8b66\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"602\" data-original=\"https:\u002F\u002Fpica.zhimg.com\u002Fv2-9574dda1ed2e69b3bd56dabb3341ed5c_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002F50\u002Fv2-9574dda1ed2e69b3bd56dabb3341ed5c_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E感谢媳妇儿给画的图\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"Xt9QSwH6\"\u003E我们可以从两个方面解决连接数不够的问题：\u003C\u002Fp\u003E\u003Col\u003E\u003Cli data-pid=\"YGu0plmk\"\u003E增加可用连接数，修改环境变量\u003Ccode\u003Emax_connections\u003C\u002Fcode\u003E，默认情况下服务端的最大连接数为\u003Ccode\u003E151\u003C\u002Fcode\u003E个\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Emysql&gt; show variables like &#39;max_connections&#39;;\n+-----------------+-------+\n| Variable_name   | Value |\n+-----------------+-------+\n| max_connections | 151   |\n+-----------------+-------+\n1 row in set (0.01 sec)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Col\u003E\u003Cli data-pid=\"la5cQSyi\"\u003E及时释放不活动的连接，系统默认的客户端超时时间是28800秒（8小时），我们可以把这个值调小一点\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Emysql&gt; show variables like &#39;wait_timeout&#39;;\n+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| wait_timeout  | 28800 |\n+---------------+-------+\n1 row in set (0.01 sec)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cblockquote data-pid=\"rA9554DE\"\u003E MySQL有非常多的配置参数，并且大部分参数都提供了默认值，默认值是MySQL作者经过精心设计的，完全可以满足大部分情况的需求，不建议在不清楚参数含义的情况下贸然修改。\u003Cbr\u002F\u003E \u003C\u002Fblockquote\u003E\u003Ch3\u003E\u003Cb\u003E1.2 客户端优化\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"TlvOg5tP\"\u003E客户端能做的就是尽量减少和服务端建立连接的次数，已经建立的连接能凑合用就凑合用，别每次执行个SQL语句都创建个新连接，服务端和客户端的资源都吃不消啊。\u003C\u002Fp\u003E\u003Cp data-pid=\"IKsLkt_c\"\u003E解决的方案就是使用\u003Cb\u003E连接池\u003C\u002Fb\u003E来复用连接。\u003C\u002Fp\u003E\u003Cp data-pid=\"OhOlvvOU\"\u003E常见的数据库连接池有\u003Ccode\u003EDBCP\u003C\u002Fcode\u003E、\u003Ccode\u003EC3P0\u003C\u002Fcode\u003E、阿里的\u003Ccode\u003EDruid\u003C\u002Fcode\u003E、\u003Ccode\u003EHikari\u003C\u002Fcode\u003E，前两者用得很少了，后两者目前如日中天。\u003C\u002Fp\u003E\u003Cp data-pid=\"jXXwC5Vc\"\u003E但是需要注意的是连接池并不是越大越好，比如\u003Ccode\u003EDruid\u003C\u002Fcode\u003E的默认最大连接池大小是8，\u003Ccode\u003EHikari\u003C\u002Fcode\u003E默认最大连接池大小是10，盲目地加大连接池的大小，系统执行效率反而有可能降低。为什么？\u003C\u002Fp\u003E\u003Cp data-pid=\"SNm_JhLk\"\u003E对于每一个连接，服务端会创建一个单独的线程去处理，连接数越多，服务端创建的线程自然也就越多。而线程数超过CPU个数的情况下，CPU势必要通过分配时间片的方式进行线程的上下文切换，频繁的上下文切换会造成很大的性能开销。\u003C\u002Fp\u003E\u003Cp data-pid=\"CxIuDcnN\"\u003E\u003Cb\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Fbrettwooldridge\u002FHikariCP\u002Fwiki\u002FAbout-Pool-Sizing\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EHikari官方\u003C\u002Fa\u003E\u003C\u002Fb\u003E给出了一个\u003Ccode\u003EPostgreSQL\u003C\u002Fcode\u003E数据库连接池大小的建议值公式，\u003Ccode\u003ECPU核心数*2+1\u003C\u002Fcode\u003E。假设服务器的CPU核心数是4，把连接池设置成9就可以了。这种公式在一定程度上对其他数据库也是适用的，大家面试的时候可以吹一吹。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E2. 架构优化\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Ch3\u003E\u003Cb\u003E2.1 使用缓存\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"qaWLiW_W\"\u003E系统中难免会出现一些比较慢的查询，这些查询要么是数据量大，要么是查询复杂（关联的表多或者是计算复杂），使得查询会长时间占用连接。\u003C\u002Fp\u003E\u003Cp data-pid=\"a1nuzfif\"\u003E如果这种数据的实效性不是特别强（不是每时每刻都会变化，例如每日报表），我们可以把此类数据放入缓存系统中，在数据的缓存有效期内，直接从缓存系统中获取数据，这样就可以减轻数据库的压力并提升查询效率。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-b8c961c75169601cbbf77e5e5dc4332e_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"1064\" data-rawheight=\"338\" data-original-token=\"v2-ac037aa6e99a0f0bc79c0ca6318a2f5c\" class=\"origin_image zh-lightbox-thumb\" width=\"1064\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b8c961c75169601cbbf77e5e5dc4332e_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1064&#39; height=&#39;338&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1064\" data-rawheight=\"338\" data-original-token=\"v2-ac037aa6e99a0f0bc79c0ca6318a2f5c\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1064\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b8c961c75169601cbbf77e5e5dc4332e_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-b8c961c75169601cbbf77e5e5dc4332e_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E缓存的使用\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch3\u003E\u003Cb\u003E2.2 读写分离（集群、主从复制）\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"2tcrkjg8\"\u003E项目的初期，数据库通常都是运行在一台服务器上的，用户的所有读写请求会直接作用到这台数据库服务器，单台服务器承担的并发量毕竟是有限的。\u003C\u002Fp\u003E\u003Cp data-pid=\"TG4tA2l9\"\u003E针对这个问题，我们可以同时使用多台数据库服务器，将其中一台设置为为小组长，称之为\u003Ccode\u003Emaster\u003C\u002Fcode\u003E节点，其余节点作为组员，叫做\u003Ccode\u003Eslave\u003C\u002Fcode\u003E。用户写数据只往\u003Ccode\u003Emaster\u003C\u002Fcode\u003E节点写，而读的请求分摊到各个\u003Ccode\u003Eslave\u003C\u002Fcode\u003E节点上。这个方案叫做\u003Cb\u003E读写分离\u003C\u002Fb\u003E。给组长加上组员组成的小团体起个名字，叫\u003Cb\u003E集群\u003C\u002Fb\u003E。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpica.zhimg.com\u002F50\u002Fv2-578cf67d8b84abff29fed48081c50f08_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"708\" data-rawheight=\"594\" data-original-token=\"v2-187cfb9877d8e349dba34d34f66f8a5a\" class=\"origin_image zh-lightbox-thumb\" width=\"708\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-578cf67d8b84abff29fed48081c50f08_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;708&#39; height=&#39;594&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"708\" data-rawheight=\"594\" data-original-token=\"v2-187cfb9877d8e349dba34d34f66f8a5a\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"708\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-578cf67d8b84abff29fed48081c50f08_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpica.zhimg.com\u002F50\u002Fv2-578cf67d8b84abff29fed48081c50f08_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E这就是集群\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cblockquote data-pid=\"GHdavawx\"\u003E 注：很多开发者不满\u003Ccode\u003Emaster-slave\u003C\u002Fcode\u003E这种具有侵犯性的词汇（因为他们认为会联想到种族歧视、黑人奴隶等），所以发起了一项更名运动。\u003Cbr\u002F\u003E 受此影响MySQL也会逐渐停用\u003Ccode\u003Emaster\u003C\u002Fcode\u003E、\u003Ccode\u003Eslave\u003C\u002Fcode\u003E等术语，转而用\u003Ccode\u003Esource\u003C\u002Fcode\u003E和\u003Ccode\u003Ereplica\u003C\u002Fcode\u003E替代，大家碰到的时候明白即可。\u003Cbr\u002F\u003E \u003C\u002Fblockquote\u003E\u003Cp data-pid=\"PJI_rRFp\"\u003E使用集群必然面临一个问题，就是多个节点之间怎么保持数据的一致性。毕竟写请求只往\u003Ccode\u003Emaster\u003C\u002Fcode\u003E节点上发送了，只有\u003Ccode\u003Emaster\u003C\u002Fcode\u003E节点的数据是最新数据，怎么把对\u003Ccode\u003Emaster\u003C\u002Fcode\u003E节点的写操作也同步到各个\u003Ccode\u003Eslave\u003C\u002Fcode\u003E节点上呢？\u003C\u002Fp\u003E\u003Cp data-pid=\"1pTBqdw5\"\u003E\u003Cb\u003E主从复制\u003C\u002Fb\u003E技术来了！我在\u003Cb\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fmp.weixin.qq.com\u002Fs%3F__biz%3DMzI1MDU0MTc2MQ%3D%3D%26mid%3D2247484093%26idx%3D1%26sn%3Df0fb512d536701c3e0ecdbf330fd6f9d%26chksm%3De981e113def668058493e9102039b45034312946326fca9906744615b4547a364aa7bc445c16%26token%3D795558921%26lang%3Dzh_CN%23rd\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E一条SQL更新语句是如何执行的？\u003C\u002Fa\u003E\u003C\u002Fb\u003E中粗浅地介绍了一下binlog日志，我直接搬过来了。\u003C\u002Fp\u003E\u003Cp data-pid=\"mMxQRJyu\"\u003E\u003Ccode\u003Ebinlog\u003C\u002Fcode\u003E是实现MySQL主从复制功能的核心组件。\u003Ccode\u003Emaster\u003C\u002Fcode\u003E节点会将所有的写操作记录到binlog中，\u003Ccode\u003Eslave\u003C\u002Fcode\u003E节点会有专门的I\u002FO线程读取\u003Ccode\u003Emaster\u003C\u002Fcode\u003E节点的binlog，将写操作同步到当前所在的\u003Ccode\u003Eslave\u003C\u002Fcode\u003E节点。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002F50\u002Fv2-d1c25d0e92f819f9de658ad8d0cc5cdb_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"1296\" data-rawheight=\"914\" data-original-token=\"v2-200ad4e57d468b23bd571158ff8b5b54\" class=\"origin_image zh-lightbox-thumb\" width=\"1296\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-d1c25d0e92f819f9de658ad8d0cc5cdb_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1296&#39; height=&#39;914&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1296\" data-rawheight=\"914\" data-original-token=\"v2-200ad4e57d468b23bd571158ff8b5b54\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1296\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-d1c25d0e92f819f9de658ad8d0cc5cdb_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002F50\u002Fv2-d1c25d0e92f819f9de658ad8d0cc5cdb_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E主从复制\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"nwhsNHU_\"\u003E这种集群的架构对减轻主数据库服务器的压力有非常好的效果，但是随着业务数据越来越多，如果某张表的数据量急剧增加，单表的查询性能就会大幅下降，而这个问题是读写分离也无法解决的，毕竟所有节点存放的是一模一样的数据啊，单表查询性能差，说的自然也是所有节点性能都差。\u003C\u002Fp\u003E\u003Cp data-pid=\"Mtylf8yu\"\u003E这时我们可以把单个节点的数据分散到多个节点上进行存储，这就是\u003Cb\u003E分库分表\u003C\u002Fb\u003E。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E2.3 分库分表\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"l4v2NGla\"\u003E分库分表中的节点的含义比较宽泛，要是把数据库作为节点，那就是分库；如果把单张表作为节点，那就是分表。\u003C\u002Fp\u003E\u003Cp data-pid=\"HAKCeMrA\"\u003E大家都知道分库分表分成垂直分库、垂直分表、水平分库和水平分表，但是每次都记不住这些概念，我就给大家详细说一说，帮助大家理解。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E2.3.1 垂直分库\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002F50\u002Fv2-241fa8c1202b0d5881d460a290df4d17_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"912\" data-rawheight=\"472\" data-original-token=\"v2-583c0be9eb4361239a4c30ba69c4ada3\" class=\"origin_image zh-lightbox-thumb\" width=\"912\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-241fa8c1202b0d5881d460a290df4d17_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;912&#39; height=&#39;472&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"912\" data-rawheight=\"472\" data-original-token=\"v2-583c0be9eb4361239a4c30ba69c4ada3\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"912\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-241fa8c1202b0d5881d460a290df4d17_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002F50\u002Fv2-241fa8c1202b0d5881d460a290df4d17_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E垂直分库\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"kZrkAkPp\"\u003E在单体数据库的基础上垂直切几刀，按照业务逻辑拆分成不同的数据库，这就是\u003Cb\u003E垂直分库\u003C\u002Fb\u003E啦。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-1174629a89b6ad4cf689c0ac6849ef93_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"1364\" data-rawheight=\"648\" data-original-token=\"v2-95f16f447bed5a8a6bfe0b29943af646\" class=\"origin_image zh-lightbox-thumb\" width=\"1364\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-1174629a89b6ad4cf689c0ac6849ef93_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1364&#39; height=&#39;648&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1364\" data-rawheight=\"648\" data-original-token=\"v2-95f16f447bed5a8a6bfe0b29943af646\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1364\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-1174629a89b6ad4cf689c0ac6849ef93_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-1174629a89b6ad4cf689c0ac6849ef93_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E垂直分库\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch3\u003E\u003Cb\u003E2.3.2 垂直分表\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-2354d22deaffe293a9f2a1ff613e0793_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"1122\" data-rawheight=\"386\" data-original-token=\"v2-ab6bb47c113fe2be555c5bd0acea9495\" class=\"origin_image zh-lightbox-thumb\" width=\"1122\" data-original=\"https:\u002F\u002Fpica.zhimg.com\u002Fv2-2354d22deaffe293a9f2a1ff613e0793_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1122&#39; height=&#39;386&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1122\" data-rawheight=\"386\" data-original-token=\"v2-ab6bb47c113fe2be555c5bd0acea9495\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1122\" data-original=\"https:\u002F\u002Fpica.zhimg.com\u002Fv2-2354d22deaffe293a9f2a1ff613e0793_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-2354d22deaffe293a9f2a1ff613e0793_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E垂直分表\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"12dA7HSb\"\u003E垂直分表就是在单表的基础上垂直切一刀（或几刀），将一个表的多个字短拆成若干个小表，这种操作需要根据具体业务来进行判断，通常会把经常使用的字段（热字段）分成一个表，不经常使用或者不立即使用的字段（冷字段）分成一个表，提升查询速度。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpica.zhimg.com\u002F50\u002Fv2-2112b867561f3d058cd8d687088a1a1c_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"1628\" data-rawheight=\"700\" data-original-token=\"v2-354eb5d602ce7bdadc31fb645615ada4\" class=\"origin_image zh-lightbox-thumb\" width=\"1628\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-2112b867561f3d058cd8d687088a1a1c_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1628&#39; height=&#39;700&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1628\" data-rawheight=\"700\" data-original-token=\"v2-354eb5d602ce7bdadc31fb645615ada4\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1628\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-2112b867561f3d058cd8d687088a1a1c_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpica.zhimg.com\u002F50\u002Fv2-2112b867561f3d058cd8d687088a1a1c_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E垂直分表\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"uWYPGacX\"\u003E拿上图举例：通常情况下商品的详情信息都比较长，而且查看商品列表时往往不需要立即展示商品详情（一般都是点击详情按钮才会进行显示），而是会将商品更重要的信息（价格等）展示出来，按照这个业务逻辑，我们将原来的商品表做了垂直分表。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E2.3.3 水平分表\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"MwiORkeC\"\u003E把单张表的数据按照一定的规则（行话叫分片规则）保存到多个数据表上，横着给数据表来一刀（或几刀），就是\u003Cb\u003E水平分表\u003C\u002Fb\u003E了。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-e429902adf5b2ab446adc1deb572d32a_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"1656\" data-rawheight=\"552\" data-original-token=\"v2-71ec31d9dd950044861972e0deb527c4\" class=\"origin_image zh-lightbox-thumb\" width=\"1656\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e429902adf5b2ab446adc1deb572d32a_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1656&#39; height=&#39;552&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1656\" data-rawheight=\"552\" data-original-token=\"v2-71ec31d9dd950044861972e0deb527c4\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1656\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e429902adf5b2ab446adc1deb572d32a_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-e429902adf5b2ab446adc1deb572d32a_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E水平分表\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-a00410a431eb2b98cac29d0c21a40924_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"2060\" data-rawheight=\"394\" data-original-token=\"v2-f6d0c58c26791988c54bc56a79d7a012\" class=\"origin_image zh-lightbox-thumb\" width=\"2060\" data-original=\"https:\u002F\u002Fpica.zhimg.com\u002Fv2-a00410a431eb2b98cac29d0c21a40924_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;2060&#39; height=&#39;394&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"2060\" data-rawheight=\"394\" data-original-token=\"v2-f6d0c58c26791988c54bc56a79d7a012\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"2060\" data-original=\"https:\u002F\u002Fpica.zhimg.com\u002Fv2-a00410a431eb2b98cac29d0c21a40924_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-a00410a431eb2b98cac29d0c21a40924_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E水平分表\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch3\u003E\u003Cb\u003E2.3.4 水平分库\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"K02-j7qz\"\u003E\u003Cb\u003E水平分库\u003C\u002Fb\u003E就是对单个数据库水平切一刀，往往伴随着水平分表。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-e6559d54b00b619425354c151a27011b_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"982\" data-rawheight=\"380\" data-original-token=\"v2-39e228049c38208faf77839f4afb3e86\" class=\"origin_image zh-lightbox-thumb\" width=\"982\" data-original=\"https:\u002F\u002Fpica.zhimg.com\u002Fv2-e6559d54b00b619425354c151a27011b_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;982&#39; height=&#39;380&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"982\" data-rawheight=\"380\" data-original-token=\"v2-39e228049c38208faf77839f4afb3e86\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"982\" data-original=\"https:\u002F\u002Fpica.zhimg.com\u002Fv2-e6559d54b00b619425354c151a27011b_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-e6559d54b00b619425354c151a27011b_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E水平分库\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-b8b7fe1f70ecd373f21507c13bf979bc_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"1390\" data-rawheight=\"1008\" data-original-token=\"v2-8dbb5a2acac5ec95ed39a4cf07be6c75\" class=\"origin_image zh-lightbox-thumb\" width=\"1390\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b8b7fe1f70ecd373f21507c13bf979bc_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1390&#39; height=&#39;1008&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1390\" data-rawheight=\"1008\" data-original-token=\"v2-8dbb5a2acac5ec95ed39a4cf07be6c75\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1390\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b8b7fe1f70ecd373f21507c13bf979bc_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpicx.zhimg.com\u002F50\u002Fv2-b8b7fe1f70ecd373f21507c13bf979bc_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E水平分库\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch3\u003E\u003Cb\u003E2.3.5 总结\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"D_6eyOPn\"\u003E\u003Cb\u003E水平分，主要是为了解决存储的瓶颈；垂直分，主要是为了减轻并发压力。\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E2.4 消息队列削峰\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"lVm58i1O\"\u003E通常情况下，用户的请求会直接访问数据库，如果同一时刻在线用户数量非常庞大，极有可能压垮数据库（参考明星出轨或公布恋情时微博的状态）。\u003C\u002Fp\u003E\u003Cp data-pid=\"bmq37pH2\"\u003E这种情况下可以通过使用消息队列降低数据库的压力，不管同时有多少个用户请求，先存入消息队列，然后系统有条不紊地从消息队列中消费请求。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpica.zhimg.com\u002F50\u002Fv2-833db19f5fb348278a4f3b4b38932895_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"814\" data-rawheight=\"798\" data-original-token=\"v2-603c11f9f729a1080dddb05a4aed9f90\" class=\"origin_image zh-lightbox-thumb\" width=\"814\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-833db19f5fb348278a4f3b4b38932895_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;814&#39; height=&#39;798&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"814\" data-rawheight=\"798\" data-original-token=\"v2-603c11f9f729a1080dddb05a4aed9f90\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"814\" data-original=\"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-833db19f5fb348278a4f3b4b38932895_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpica.zhimg.com\u002F50\u002Fv2-833db19f5fb348278a4f3b4b38932895_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003E队列削峰\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch2\u003E\u003Cb\u003E3. 优化器——SQL分析与优化\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp data-pid=\"STOJ6mbR\"\u003E处理完连接、优化完缓存等架构的事情，SQL查询语句来到了解析器和优化器的地盘了。在这一步如果出了任何问题，那就只能是SQL语句的问题了。\u003C\u002Fp\u003E\u003Cp data-pid=\"_Ooj9oKn\"\u003E只要你的语法不出问题，解析器就不会有问题。此外，为了防止你写的SQL运行效率低，优化器会自动做一些优化，但如果实在是太烂，优化器也救不了你了，只能眼睁睁地看着你的SQL查询沦为\u003Cb\u003E慢查询\u003C\u002Fb\u003E。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E3.1 慢查询\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"SeTAdpYs\"\u003E\u003Cb\u003E慢查询\u003C\u002Fb\u003E就是执行地很慢的查询（这句话说得跟废话似的。。。），只有知道MySQL中有哪些慢查询我们才能针对性地进行优化。\u003C\u002Fp\u003E\u003Cp data-pid=\"pTSEBZMS\"\u003E因为开启慢查询日志是有性能代价的，因此MySQL默认是关闭慢查询日志功能，使用以下命令查看当前慢查询状态\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Emysql&gt; show variables like &#39;slow_query%&#39;;\n+---------------------+--------------------------------------+\n| Variable_name       | Value                                |\n+---------------------+--------------------------------------+\n| slow_query_log      | OFF                                  |\n| slow_query_log_file | \u002Fvar\u002Flib\u002Fmysql\u002F9e74f9251f6c-slow.log |\n+---------------------+--------------------------------------+\n2 rows in set (0.00 sec)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"v6JI39Cs\"\u003E\u003Ccode\u003Eslow_query_log\u003C\u002Fcode\u003E表示当前慢查询日志是否开启，\u003Ccode\u003Eslow_query_log_file\u003C\u002Fcode\u003E表示慢查询日志的保存位置。\u003C\u002Fp\u003E\u003Cp data-pid=\"8iQiamDr\"\u003E除了上面两个变量，我们还需要确定“慢”的指标是什么，即执行超过多长时间才算是慢查询，默认是\u003Ccode\u003E10S\u003C\u002Fcode\u003E，如果改成\u003Ccode\u003E0\u003C\u002Fcode\u003E的话就是记录所有的SQL。\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Emysql&gt; show variables like &#39;%long_query%&#39;;\n+-----------------+-----------+\n| Variable_name   | Value     |\n+-----------------+-----------+\n| long_query_time | 10.000000 |\n+-----------------+-----------+\n1 row in set (0.00 sec)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3\u003E\u003Cb\u003E3.1.1 打开慢日志\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"khQbE6rG\"\u003E有两种打开慢日志的方式\u003C\u002Fp\u003E\u003Col\u003E\u003Cli data-pid=\"-wjUnDSQ\"\u003E修改配置文件\u003Ccode\u003Emy.cnf\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp data-pid=\"eIoMggk9\"\u003E此种修改方式系统重启后依然有效\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E# 是否开启慢查询日志\nslow_query_log=ON\n# \nlong_query_time=2\nslow_query_log_file=\u002Fvar\u002Flib\u002Fmysql\u002Fslow.log\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Col\u003E\u003Cli data-pid=\"Eii8ttQF\"\u003E动态修改参数（重启后失效）\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Emysql&gt; set @@global.slow_query_log=1;\nQuery OK, 0 rows affected (0.06 sec)\n\nmysql&gt; set @@global.long_query_time=2;\nQuery OK, 0 rows affected (0.00 sec)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3\u003E\u003Cb\u003E3.1.2 慢日志分析\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"Av6sQct3\"\u003EMySQL不仅为我们保存了慢日志文件，还为我们提供了慢日志查询的工具\u003Ccode\u003Emysqldumpslow\u003C\u002Fcode\u003E，为了演示这个工具，我们先构造一条慢查询：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Emysql&gt; SELECT sleep(5);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"e7GeUahD\"\u003E然后我们查询用时最多的1条慢查询：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E[root@iZ2zejfuakcnnq2pgqyzowZ ~]# mysqldumpslow -s t -t 1 -g &#39;select&#39; \u002Fvar\u002Flib\u002Fmysql\u002F9e74f9251f6c-slow.log\n\nReading mysql slow query log from \u002Fvar\u002Flib\u002Fmysql\u002F9e74f9251f6c-slow.log\nCount: 1  Time=10.00s (10s)  Lock=0.00s (0s)  Rows=1.0 (1), root[root]@localhost\n  SELECT sleep(N)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"mX4JS1DP\"\u003E其中，\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"3pPBn-PK\"\u003E\u003Cb\u003ECount\u003C\u002Fb\u003E：表示这个SQL执行的次数\u003C\u002Fli\u003E\u003Cli data-pid=\"iEtmpTHA\"\u003E\u003Cb\u003ETime\u003C\u002Fb\u003E：表示执行的时间，括号中的是累积时间\u003C\u002Fli\u003E\u003Cli data-pid=\"8XDgff5_\"\u003E\u003Cb\u003ELocks\u003C\u002Fb\u003E：表示锁定的时间，括号中的是累积时间\u003C\u002Fli\u003E\u003Cli data-pid=\"YV_s5K6x\"\u003E\u003Cb\u003ERows\u003C\u002Fb\u003E：表示返回的记录数，括号中的是累积数\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"o0xoc2s7\"\u003E更多关于\u003Ccode\u003Emysqldumpslow\u003C\u002Fcode\u003E的使用方式，可以查阅官方文档，或者执行\u003Ccode\u003Emysqldumpslow --help\u003C\u002Fcode\u003E寻求帮助。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E3.2 查看运行中的线程\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"pzDt9iNm\"\u003E我们可以运行\u003Ccode\u003Eshow full processlist\u003C\u002Fcode\u003E查看MySQL中运行的所有线程，查看其状态和运行时间，找到不顺眼的，直接kill。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002F50\u002Fv2-7d33d6083900479e45a778e04f14f014_720w.jpg?source=2c26e567\" data-size=\"normal\" data-rawwidth=\"2124\" data-rawheight=\"446\" data-original-token=\"v2-6ca06258e399429b3bda093fd44c9a0b\" class=\"origin_image zh-lightbox-thumb\" width=\"2124\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-7d33d6083900479e45a778e04f14f014_r.jpg?source=2c26e567\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;2124&#39; height=&#39;446&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"2124\" data-rawheight=\"446\" data-original-token=\"v2-6ca06258e399429b3bda093fd44c9a0b\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"2124\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-7d33d6083900479e45a778e04f14f014_r.jpg?source=2c26e567\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002F50\u002Fv2-7d33d6083900479e45a778e04f14f014_720w.jpg?source=2c26e567\"\u002F\u003E\u003Cfigcaption\u003Eimage-20220405182328247\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"-JAUDhvp\"\u003E其中，\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"iZ7EYlvR\"\u003E\u003Cb\u003EId\u003C\u002Fb\u003E：线程的唯一标志，可以使用Id杀死指定线程\u003C\u002Fli\u003E\u003Cli data-pid=\"Q6JrOCsk\"\u003E\u003Cb\u003EUser\u003C\u002Fb\u003E：启动这个线程的用户，普通账户只能查看自己的线程\u003C\u002Fli\u003E\u003Cli data-pid=\"UXGWexKa\"\u003E\u003Cb\u003EHost\u003C\u002Fb\u003E：哪个ip和端口发起的连接\u003C\u002Fli\u003E\u003Cli data-pid=\"eyM-Emv6\"\u003E\u003Cb\u003Edb\u003C\u002Fb\u003E：线程操作的数据库\u003C\u002Fli\u003E\u003Cli data-pid=\"XMFsWIMm\"\u003E\u003Cb\u003ECommand\u003C\u002Fb\u003E：线程的命令\u003C\u002Fli\u003E\u003Cli data-pid=\"J2eIXdgV\"\u003E\u003Cb\u003ETime\u003C\u002Fb\u003E：操作持续时间，单位秒\u003C\u002Fli\u003E\u003Cli data-pid=\"bmlr_5_p\"\u003E\u003Cb\u003EState\u003C\u002Fb\u003E：线程的状态\u003C\u002Fli\u003E\u003Cli data-pid=\"gxCkjWQY\"\u003E\u003Cb\u003EInfo\u003C\u002Fb\u003E：SQL语句的前100个字符\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch3\u003E\u003Cb\u003E3.3 查看服务器运行状态\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"P4fgOKg-\"\u003E使用\u003Ccode\u003ESHOW STATUS\u003C\u002Fcode\u003E查看MySQL服务器的运行状态，有\u003Ccode\u003Esession\u003C\u002Fcode\u003E和\u003Ccode\u003Eglobal\u003C\u002Fcode\u003E两种作用域，一般使用\u003Ccode\u003Elike+通配符\u003C\u002Fcode\u003E进行过滤。\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E-- 查看select的次数\nmysql&gt; SHOW GLOBAL STATUS LIKE &#39;com_select&#39;;\n+---------------+--------+\n| Variable_name | Value  |\n+---------------+--------+\n| Com_select    | 168241 |\n+---------------+--------+\n1 row in set (0.05 sec)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3\u003E\u003Cb\u003E3.4 查看存储引擎运行信息\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"Zg9EYjtG\"\u003E\u003Ccode\u003ESHOW ENGINE\u003C\u002Fcode\u003E用来展示存储引擎的当前运行信息，包括事务持有的表锁、行锁信息；事务的锁等待情况；线程信号量等待；文件IO请求；Buffer pool统计信息等等数据。\u003C\u002Fp\u003E\u003Cp data-pid=\"Iv7ykxVS\"\u003E例如：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003ESHOW ENGINE INNODB STATUS;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"D2IGOy1a\"\u003E上面这条语句可以展示innodb存储引擎的当前运行的各种信息，大家可以据此找到MySQL当前的问题，限于篇幅不在此意义说明其中信息的含义，大家只要知道MySQL提供了这样一个监控工具就行了，等到需要的时候再来用就好。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E3.5 EXPLAIN执行计划\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"Jm-as6eU\"\u003E通过慢查询日志我们可以知道哪些SQL语句执行慢了，可是为什么慢？慢在哪里呢？\u003C\u002Fp\u003E\u003Cp data-pid=\"4Y8BEuuy\"\u003EMySQL提供了一个执行计划的查询命令\u003Ccode\u003EEXPLAIN\u003C\u002Fcode\u003E，通过此命令我们可以查看SQL执行的计划，所谓执行计划就是：优化器会不会优化我们自己书写的SQL语句（比如外连接改内连接查询，子查询优化为连接查询...）、优化器针对此条SQL的执行对哪些索引进行了成本估算，并最终决定采用哪个索引（或者最终选择不用索引，而是全表扫描）、优化器对单表执行的策略是什么，等等等等。\u003C\u002Fp\u003E\u003Cblockquote data-pid=\"tN0cWLEs\"\u003E EXPLAIN在MySQL5.6.3之后也可以针对UPDATE、DELETE和INSERT语句进行分析，但是通常情况下我们还是用在SELECT查询上。\u003Cbr\u002F\u003E \u003C\u002Fblockquote\u003E\u003Cp data-pid=\"R4xiqmFq\"\u003E这篇文章主要是从宏观上多个角度介绍MySQL的优化策略，因此这里不详细说明\u003Ccode\u003EEXPLAIN\u003C\u002Fcode\u003E的细节，之后单独成篇。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E3.6 SQL与索引优化\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Ch3\u003E\u003Cb\u003E3.6.1 SQL优化\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"UJzJRUZY\"\u003ESQL优化指的是SQL本身语法没有问题，但是有实现相同目的的更好的写法。比如：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"sbII9dyN\"\u003E使用小表驱动大表；用join改写子查询；or改成union\u003C\u002Fli\u003E\u003Cli data-pid=\"xdD0jmuv\"\u003E连接查询中，尽量减少驱动表的扇出（记录数），访问被驱动表的成本要尽量低，尽量在被驱动表的连接列上建立索引，降低访问成本；被驱动表的连接列最好是该表的主键或者是唯一二级索引列，这样被驱动表的成本会降到更低\u003C\u002Fli\u003E\u003Cli data-pid=\"WhxsX1SB\"\u003E大偏移量的limit，先过滤再排序\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"rBGX3MAV\"\u003E针对最后一条举个简单的例子，下面两条语句能实现同样的目的，但是第二条的执行效率比第一条执行效率要高得多（存储引擎使用的是InnoDB），大家感受一下：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E-- 1. 大偏移量的查询\nmysql&gt; SELECT * FROM user_innodb LIMIT 9000000,10;\nEmpty set (8.18 sec)\n\n-- 2.先过滤ID（因为ID使用的是索引），再limit\nmysql&gt; SELECT * FROM user_innodb WHERE id &gt; 9000000 LIMIT 10;\nEmpty set (0.02 sec)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3\u003E\u003Cb\u003E3.6.2 索引优化\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"3XQ1d35F\"\u003E为慢查询创建适当的索引是个非常常见并且非常有效的方法，但是索引是否会被高效使用又是另一门学问了。\u003C\u002Fp\u003E\u003Cp data-pid=\"7ifqvF_C\"\u003E我之前写过一篇\u003Cb\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fmp.weixin.qq.com\u002Fs%3F__biz%3DMzI1MDU0MTc2MQ%3D%3D%26mid%3D2247484338%26idx%3D1%26sn%3Df753421c70f0e436c040af9e969c3331%26chksm%3De981e01cdef6690ae6e4bec7c92b436019f5f30e02f35524ca8e144a92b8aa743fc2c51d2c27%26token%3D1056536482%26lang%3Dzh_CN%23rd\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E用好MySQL索引，你必须知道的一些事情 \u003C\u002Fa\u003E\u003C\u002Fb\u003E，感兴趣的读者可以看一下。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E4. 存储引擎与表结构\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Ch3\u003E\u003Cb\u003E4.1 选择存储引擎\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"x3ZKlh2_\"\u003E一般情况下，我们会选择MySQL默认的存储引擎存储引擎\u003Ccode\u003EInnoDB\u003C\u002Fcode\u003E，但是当对数据库性能要求精益求精的时候，存储引擎的选择也成为一个关键的影响因素。\u003C\u002Fp\u003E\u003Cp data-pid=\"KN788VBF\"\u003E建议根据不同的业务选择不同的存储引擎，例如：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"gGdUNAA8\"\u003E查询操作、插入操作多的业务表，推荐使用\u003Ccode\u003EMyISAM\u003C\u002Fcode\u003E；\u003C\u002Fli\u003E\u003Cli data-pid=\"SA8AEwcp\"\u003E临时表使用\u003Ccode\u003EMemory\u003C\u002Fcode\u003E；\u003C\u002Fli\u003E\u003Cli data-pid=\"sGx8yHM7\"\u003E并发数量大、更新多的业务选择使用\u003Ccode\u003EInnoDB\u003C\u002Fcode\u003E；\u003C\u002Fli\u003E\u003Cli data-pid=\"p7p17rmb\"\u003E不知道选啥直接默认。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch3\u003E\u003Cb\u003E4.2 优化字段\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"Rg7Pc5Sp\"\u003E字段优化的最终原则是：\u003Cb\u003E使用可以正确存储数据的最小的数据类型\u003C\u002Fb\u003E。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E4.2.1 整数类型\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"4-CaBYHn\"\u003EMySQL提供了6种整数类型，分别是\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"jAQ_9rdV\"\u003E\u003Cb\u003Etinyint\u003C\u002Fb\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"lVbmpBzo\"\u003E\u003Cb\u003Esmallint\u003C\u002Fb\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"R2Kkcnnk\"\u003E\u003Cb\u003Emediumint\u003C\u002Fb\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"Oeu715AK\"\u003E\u003Cb\u003Eint\u003C\u002Fb\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"4yo5i2Yh\"\u003E\u003Cb\u003Einteger\u003C\u002Fb\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"JLn_NAJQ\"\u003E\u003Cb\u003Ebigint\u003C\u002Fb\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"Xh46gXlp\"\u003E不同的存储类型的最大存储范围不同，占用的存储的空间自然也不同。\u003C\u002Fp\u003E\u003Cp data-pid=\"udEbsv_a\"\u003E例如，是否被删除的标识，建议选用\u003Ccode\u003Etinyint\u003C\u002Fcode\u003E，而不是\u003Ccode\u003Ebigint\u003C\u002Fcode\u003E。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E4.2.2 字符类型\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"Uu9aoNfO\"\u003E你是不是直接把所有字符串的字段都设置为\u003Ccode\u003Evarchar\u003C\u002Fcode\u003E格式了？甚至怕不够，还会直接设置成\u003Ccode\u003Evarchar(1024)\u003C\u002Fcode\u003E的长度？\u003C\u002Fp\u003E\u003Cp data-pid=\"6ooXZFsP\"\u003E如果不确定字段的长度，肯定是要选择\u003Ccode\u003Evarchar\u003C\u002Fcode\u003E，但是\u003Ccode\u003Evarchar\u003C\u002Fcode\u003E需要额外的空间来记录该字段目前占用的长度；因此如果字段的长度是固定的，尽量选用\u003Ccode\u003Echar\u003C\u002Fcode\u003E，这会给你节约不少的内存空间。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E4.2.3 非空\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"EquC9qvx\"\u003E非空字段尽量设置成\u003Ccode\u003ENOT NULL\u003C\u002Fcode\u003E，并提供默认值，或者使用特殊值代替\u003Ccode\u003ENULL\u003C\u002Fcode\u003E。\u003C\u002Fp\u003E\u003Cp data-pid=\"WJ1yD-WY\"\u003E因为\u003Ccode\u003ENULL\u003C\u002Fcode\u003E类型的存储和优化都会存在性能不佳的问题，具体原因在这里就不展开了。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E4.2.4 不要用外键、触发器和视图功能\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"vFZmGCB_\"\u003E这也是「阿里巴巴开发手册」中提到的原则。原因有三个：\u003C\u002Fp\u003E\u003Col\u003E\u003Cli data-pid=\"r0tzF_0s\"\u003E降低了可读性，检查代码的同时还得查看数据库的代码；\u003C\u002Fli\u003E\u003Cli data-pid=\"WvGTXAM5\"\u003E把计算的工作交给程序，数据库只做好存储的工作，并把这件事情做好；\u003C\u002Fli\u003E\u003Cli data-pid=\"EIfRZEYR\"\u003E数据的完整性校验的工作应该由开发者完成，而不是依赖于外键，一旦用了外键，你会发现测试的时候随便删点垃圾数据都变得异常艰难。\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Ch3\u003E\u003Cb\u003E4.2.5 图片、音频、视频存储\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"W0AGPKc2\"\u003E不要直接存储大文件，而是要存储大文件的访问地址。\u003C\u002Fp\u003E\u003Ch3\u003E\u003Cb\u003E4.2.6 大字段拆分和数据冗余\u003C\u002Fb\u003E\u003C\u002Fh3\u003E\u003Cp data-pid=\"utlW0HSg\"\u003E\u003Cb\u003E大字段拆分\u003C\u002Fb\u003E其实就是前面说过的垂直分表，把不常用的字段或者数据量较大的字段拆分出去，避免列数过多和数据量过大，尤其是习惯编写\u003Ccode\u003ESELECT *\u003C\u002Fcode\u003E的情况下，列数多和数据量大导致的问题会被严重放大！\u003C\u002Fp\u003E\u003Cp data-pid=\"DiCktwrm\"\u003E\u003Cb\u003E字段冗余\u003C\u002Fb\u003E原则上不符合数据库设计范式，但是却非常有利于快速检索。比如，合同表中存储客户id的同时可以冗余存储客户姓名，这样查询时就不需要再根据客户id获取用户姓名了。因此针对业务逻辑适当做一定程度的冗余也是一种比较好的优化技巧。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E5. 业务优化\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp data-pid=\"d1acSoQn\"\u003E严格来说，业务方面的优化已经不算是MySQL调优的手段了，但是业务的优化却能非常有效地减轻数据库访问压力，这方面一个典型例子就是淘宝，下面举几个简单例子给大家提供一下思路：\u003C\u002Fp\u003E\u003Col\u003E\u003Cli data-pid=\"6sUjs2kn\"\u003E以往都是双11当晚开始买买买的模式，最近几年双11的预售战线越拉越长，提前半个多月就开始了，而且各种定金红包模式丛出不穷，这种方式叫做\u003Cb\u003E预售分流\u003C\u002Fb\u003E。这样做可以分流客户的服务请求，不必等到双十一的凌晨一股脑地集体下单；\u003C\u002Fli\u003E\u003Cli data-pid=\"MYqR_U2N\"\u003E双十一的凌晨你或许想查询当天之外的订单，但是却查询失败；甚至支付宝里的小鸡的口粮都被延迟发放了，这是一种\u003Cb\u003E降级策略\u003C\u002Fb\u003E，集结不重要的服务的计算资源，用来保证当前最核心的业务；\u003C\u002Fli\u003E\u003Cli data-pid=\"xPmr6tx1\"\u003E双十一的时候支付宝极力推荐使用花呗支付，而不是银行卡支付，虽然一部分考量是提高软件粘性，但是另一方面，使用余额宝实际使用的阿里内部服务器，访问速度快，而使用银行卡，需要调用银行接口，相比之下操作要慢了许多。\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Chr\u002F\u003E\u003Cp data-pid=\"CZ2Baeox\"\u003EMySQL优化的总结写到此就结束了，其中有不少细节没有提及，多少让我感觉这篇文章不完美。但是有些知识点掰开讲又太多了，不可能一下子全部写下，之后再好好写吧。\u003C\u002Fp\u003E\u003Cp data-pid=\"HmQKlcrU\"\u003E我是蝉沐风，公众号「蝉沐风」，一个认真写文章的技术人，下期见！\u003C\u002Fp\u003E","createdTime":1649202898,"editableContent":"","excerpt":"面试官如果问你：你会从哪些维度进行MySQL性能优化？你会怎么回答？ 所谓的性能优化，一般针对的是MySQL查询的优化。既然是优化查询，我们自然要先知道查询操作要经过哪些环节，然后思考可以在哪些环节进行优化。 我之前写过 一条SQL查询语句是如何执行的？ ，感兴趣的朋友可以阅读一下，我用其中的一张图展示查询操作需要经历的基本环节。 [图片] 下面从5个角度介绍一下MySQL优化的一些策略。 [图片] 1. 连接配置优化处理连接是MySQL客户端和MyS…","extras":"","id":2425182871,"isCollapsed":false,"isCopyable":true,"isJumpNative":false,"isLabeled":false,"isNormal":true,"isSticky":false,"isVisible":true,"question":{"created":1631518921,"id":486575193,"questionType":"normal","relationship":{},"title":"mysql 优化方法有哪些？","type":"question","updatedTime":1631518921,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F486575193"},"reactionInstruction":{},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"upvotedFollowees":[],"voting":0},"relevantInfo":{"isRelevant":false,"relevantText":"","relevantType":""},"reshipmentSettings":"allowed","rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"settings":{"tableOfContents":{"enabled":false}},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"description":"","note":"","reason":"","reasonId":0,"status":""},"url":""},"type":"answer","updatedTime":1649202898,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F2425182871","voteupCount":66}},"articles":{},"columns":{},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"zvideos":{},"zvideoContributions":{},"briefs":{},"eduCourses":{}},"currentUser":"","account":{"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false},"cardUserInfo":{"vipInfo":{}},"handleWidget":{},"widgetList":[],"userWidgetId":""},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{},"infinity":{},"batchUsers":{},"profileInfinity":null},"env":{"ab":{"config":{},"triggers":{}},"abV2":{"config":{"paramMap":{"in_editor_title":{"value":"0"},"ws_publish_ask":{"value":"1"},"pc_mou_cre_remove":{"value":"0"},"ws_platform_new":{"value":"0"},"ws_publish_answer":{"value":"0"},"ws_publish_post":{"value":"0"},"uw_pc_pin_pattern":{"value":"0"},"ws_video_publish":{"value":"0"}},"abMap":{}},"triggers":{}},"userAgent":{"Edge":false,"IE":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Quark":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"WxMiniProgram":false,"BaiduMiniProgram":false,"QQMiniProgram":false,"JDMiniProgram":false,"isWebView":false,"isMiniProgram":false,"origin":""},"appViewConfig":{},"ctx":{"path":"\u002Fquestion\u002F486575193\u002Fanswer\u002F2425182871","query":{},"href":"http:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F486575193\u002Fanswer\u002F2425182871","host":"www.zhihu.com"},"trafficSource":"production","edition":{"beijing":false,"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false,"oppoSearch":false,"baiduSearch":false,"googleSearch":false,"shenma":false,"miniProgram":false,"xiaomi":false,"huaweiSearch":false},"theme":"light","appHeaderTheme":{"current":"normal","disable":true,"normal":{"bgColor":"GBK99A"},"custom":{"bgColor":"GBK99A"}},"enableShortcut":true,"referer":"","xUDId":"","mode":"ssr","conf":{},"xTrafficFreeOrigin":"","ipInfo":{},"logged":false,"vars":{"passThroughHeaders":{}}},"me":{"columnContributions":[]},"label":{},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0}},"recommend":{"recommendTimes":{}}},"explore":{},"levelUpperLimit":10,"mcn":{},"mcnManage":{},"tasks":{},"announcement":{},"creatorsRecommendInfo":{}},"creators":{"common":{"applyStatus":{},"rightsStatus":{}},"bayesDomains":{"status":{},"options":{"topDomains":null,"allDomains":null,"editable":0},"contents":null},"school":{"tabs":[],"contents":[],"banner":null,"entities":{}},"faq":{"tabs":[],"article":{}},"knowledgeIncome":{},"safeguardRights":{},"analytics":{"all":{},"answer":{},"zvideo":{},"article":{},"pin":{},"singleContent":{}},"account":{"growthLevel":{}},"KMResource":{},"training":{},"ToolsQuestion":{"goodatTopics":[]},"ToolsHotspot":{"domains":[]},"ToolsRecommend":{},"ToolsCustomPromotion":{"itemLists":{},"baseInfo":{}},"ToolsSearchQuestion":{},"editorSetting":{},"MCNManage":{},"knowledgeTasks":{},"incomeAnalysis":{"income":{"aggregation":{}}},"creationManage":{"editModal":{"status":false}},"activity":{},"announcement":{},"home":{"currentCreatorUrlToken":null,"rights":[],"newRights":[],"scoreInfo":{},"menusShowControlByServer":{"bVipRecomend":false,"creationRelationship":false},"newTasks":{"creatorTask":{"tasks":[],"des":[]}},"bannerList":[],"recentlyCreated":[],"homecard":{},"homeData":{}},"videoSupport":{"textBenefit":{}},"videoDistribution":{},"profilePoster":{"creatorPosterConfig":{},"creatorPosterData":{}}},"question":{"followers":{},"concernedFollowers":{},"answers":{},"hiddenAnswers":{},"updatedAnswers":{},"ariaAnswers":{},"collapsedAnswers":{},"notificationAnswers":{},"invitedQuestions":{"total":{"count":null,"isEnd":false,"isLoading":false,"questions":[]},"followees":{"count":null,"isEnd":false,"isLoading":false,"questions":[]}},"laterQuestions":{"count":null,"isEnd":false,"isLoading":false,"questions":[]},"waitingQuestions":{"recommend":{"isEnd":false,"isLoading":false,"questions":[]},"invite":{"isEnd":false,"isLoading":false,"questions":[]},"newest":{"isEnd":false,"isLoading":false,"questions":[]},"hot":{"isEnd":false,"isLoading":false,"questions":[]}},"invitationCandidates":{},"inviters":{},"invitees":{},"similarQuestions":{},"questionBanners":{},"relatedCommodities":{},"bio":{},"brand":{},"permission":{},"adverts":{},"advancedStyle":{},"commonAnswerCount":0,"hiddenAnswerCount":0,"topicMeta":{},"bluestarRanklist":{},"relatedSearch":{},"autoInvitation":{},"simpleConcernedFollowers":{},"draftStatus":{},"disclaimers":{},"isShowMobileSignInModal":false},"shareTexts":{},"answers":{"voters":{},"upvoters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"entityWords":{},"paidContent":{},"settings":{},"relationEndorsement":{}},"banner":{},"topic":{"bios":{},"hot":{},"newest":{},"top":{},"sticky":{},"pin":{},"unanswered":{},"questions":{},"zivdeo":{},"zvideo-new":{},"pin20":{},"pin20-new":{},"followers":{},"contributors":{},"parent":{},"children":{},"bestAnswerers":{},"wikiMeta":{},"index":{},"intro":{},"meta":{},"schema":{},"creatorWall":{},"wikiEditInfo":{},"committedWiki":{},"landingBasicData":{},"landingExcellentItems":[],"landingExcellentEditors":[],"landingCatalog":[],"landingEntries":{}},"explore":{"recommendations":{},"specials":{"entities":{},"order":[]},"roundtables":{"entities":{},"order":[]},"collections":{},"columns":{},"square":{"hotQuestionList":[],"potentialList":[]}},"articles":{"voters":{},"upvoters":{},"relationEndorsement":{}},"favlists":{"relations":{}},"pins":{"reviewing":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotList":[],"hotListHeadZone":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]},"hotDaily":{"data":[],"paging":{}},"hotHighlight":{"isFetching":false,"isDrained":false,"data":[],"paging":{}},"banner":{},"commercialBanner":{"show":false,"banner":{},"trackData":{}},"video":{"items":[],"next":null,"isLoading":false,"isDrained":false}},"upload":{},"video":{"data":{},"shareVideoDetail":{},"last":{}},"zvideos":{"campaignVideoList":{},"campaigns":{},"tagoreCategory":[],"recommendations":{},"insertable":{},"recruit":{"form":{"platform":"","nickname":"","followerCount":"","domain":"","contact":""},"submited":false,"ranking":[]},"qyActivityData":{},"talkActivityData":{},"party2022ActivityData":{},"batchVideos":{},"contribution":{"selectedContribution":null,"campaign":null,"configs":{},"contributionLists":{},"recommendQuestions":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]},"questionSearchResults":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]}},"creationReferences":{},"zvideoCollection":{},"zvideoGrant":{},"collectData":{"isFetching":false,"list":[]},"videoSource":{"isLoaded":false}},"guide":{"guide":{"isFetching":false,"isShowGuide":false}},"reward":{"answer":{},"article":{},"question":{}},"search":{"recommendSearch":[],"topSearch":{},"searchValue":{},"suggestSearch":{},"attachedInfo":{"generalByQuery":{}},"nextOffset":{"generalByQuery":{}},"topicReview":{},"sidebar":{},"calendar":{},"scores":null,"majors":{},"university":{},"generalByQuery":{},"generalByQueryInADay":{},"generalByQueryInAWeek":{},"generalByQueryInThreeMonths":{},"peopleByQuery":{},"topicByQuery":{},"zvideoByQuery":{},"scholarByQuery":{},"columnByQuery":{},"liveByQuery":{},"albumByQuery":{},"eBookByQuery":{},"kmGeneralByQuery":{},"kmCourseByQuery":{},"customFilter":{"requestFinished":false,"keys":[],"tags":[]}},"creatorSalt":{"recommendQuestionList":[],"bannerList":[],"claimBannerList":[],"sites":[],"domains":{},"hasRecored":false,"hasClaim":false,"hasContributedList":[],"notContributedList":[],"contributesTotal":null,"previewPageTitle":"","previewPageContent":"","restContributionNumber":"-"},"publicEditPermission":{},"readStatus":{},"draftHistory":{"history":{},"drafts":{}},"notifications":{"recent":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"history":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"notificationActors":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"recentNotificationEntry":"all"},"specials":{"entities":{},"all":{"data":[],"paging":{},"isLoading":false}},"collections":{"hot":{"data":[],"paging":{},"isLoading":false},"collectionFeeds":{}},"userProfit":{"permission":{"permissionStatus":{"zhiZixuan":0,"recommend":-1,"task":0,"plugin":0,"infinity":0},"visible":false},"linkCardLimit":0},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[],"lists":{},"banners":{},"protocolStatus":{"isAgreedNew":true,"isAgreedOld":true},"probationCountdownDays":0},"mcnActivity":{"household":{"products":{},"rankList":{"total":{},"yesterday":{}}}},"brand":{"contentPlugin":{}},"host":{"roundtable":{"subjects":{},"applications":{"total":0},"online":{"total":0},"applies":{},"details":{},"includedResource":{},"hotQuestions":{},"warmupContents":{},"batchInclude":{}},"special":{"applications":{"total":0,"pages":{},"entities":{}},"censorHistory":{},"drafts":{}}},"campaign":{"single":{},"list":{},"videoMakerAcq":{},"vote":{},"cardCollecting":{"message":null,"profile":{"balance":"0","chance":0,"coinNum":0,"gatherClose":false,"isGotMagicCard":false,"isPay":false,"partitionStart":false,"totalDone":0,"withdrawStart":false},"sharePoster":{"share":"","sendCard":"","invite":""},"shareLink":null,"shareIntention":"share","shareKey":null,"shareCardId":null,"inviterInfo":null,"giverInfo":null,"prize":null,"receivedCard":null,"newCoinCount":null,"newCardList":[],"newUserCardCount":1,"taskList":[],"prizeList":null,"cardList":null,"panel":{"showTaskPanel":false,"showRewardPanel":false},"modal":{"showWelcomeModal":false,"showFusionModal":false,"showFusionPromptModal":false,"showShareModal":false,"showBackModal":false}},"zhiboPandian2020":null,"boarding":{},"searchGaokaoSubPage":{},"searchHealth":{}},"knowledgePlan":{"lists":{},"allCreationRankList":{},"featuredQuestions":{}},"wallE":{"protectHistory":{"total":0,"pages":{},"entities":{}}},"roundtables":{"hotQuestions":{},"warmupContents":{},"hotDiscussions":{},"selectedContents":{},"roundtables":{}},"helpCenter":{"entities":{"question":{},"category":{}},"categories":[],"commonQuestions":[],"relatedQuestions":{},"faqTypes":[]},"republish":{},"commercialReport":{"commercialTypes":[]},"creatorMCN":{"mcn":{},"mcnStatistics":{},"mcnRight":{"bind":false,"coupon":false},"isNoAuth":false,"creatorManageData":[],"creatorManageDataTotal":1,"mcnDomains":[],"bill":{"list":{},"detail":{}},"healthScore":{"healthScore":"0","updateTime":"","evaluate":""},"healthScoreRecordInfo":{},"statisticHealthScoreData":{},"beforeDownloadCheckResult":{}},"commentManage":{"commentList":{"ids":[],"entities":{},"nextOffset":0,"urlToken":""},"subCommentList":{"ids":[],"entities":{},"paging":{"next":"","isEnd":false}}},"commentPermission":{},"creatorRightStatus":{"list":[]},"zhiPlus":{"permissionStatus":9999},"streaming":{},"creationRanking":{},"eduSections":{"eduSectionState":{}},"adPromotion":{"answer":{},"article":{}},"editVideo":{"editVideoEnabled":false}},"subAppName":"main","spanName":"AnswerPage","canaryConfig":{"test_canary":"0","use_new_player":"0","player_vendor":"0","use_hevc":"0","upload_use_signature":"0","use_backdrop_blur":"0","article_title_imagex":"0","play_station":"0","use_cached_supported_countries":"1"}}</script><script crossorigin="" src="https://static.zhihu.com/heifetz/vendor.b2043823c211547b094b.js"></script><script crossorigin="" src="https://static.zhihu.com/event/react@17.0.2/umd/react.production.min.js"></script><script crossorigin="" src="https://static.zhihu.com/event/react-dom@17.0.2/umd/react-dom.production.min.js"></script><script crossorigin="" src="https://static.zhihu.com/event/react-dom@17.0.2/umd/react-dom-server.browser.production.min.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/runtime.app.05463f8c75ebec534526.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/765.app.77140159d24e786a8c78.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/main.app.6e192eace2659b0d1528.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/lib-29107295.0692d5fe944e8fb46775.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/lib-0e5ce61e.3551e3166f54bb9b6300.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/lib-79b5cf47.ef9f36ceaff90561a471.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/lib-75fc9c18.fa82171dc3014b0aaa1d.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/lib-330004dc.42a9ad3cdb7831446b3b.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/lib-38cf5c11.3e41969946c87181f765.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/lib-2ec050f6.98bf5fd510606d46d3db.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/lib-83b0f42f.700ada454a41f08b2365.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-e5fb4baf7f81913234c8ae38d77981ef34c5b741.23ea6eb1aaaa3aa8b87c.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-0b43bf3e67dbb6b623fe8ec6c5d091d1b549b2dc.4df9af390c5f91999439.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-c1b26e28f9af848665b4dda36429ffbbc02ba722.2cef2db2292baba4776d.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-33741370830005be76ce2de074412d202d48915c.9fec12b1bd94bd10ecfd.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-11cdd05708e8231a679e46442ff0ae122532f1bc.ef517b793817666bf5a5.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-707a11ebc868d394defdec5e3c9c3bd627194a5c.94b60c70de58b7d0b9be.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-344960c9bb3f9e501026d17224a6974d3281f1a3.7e4131cf5002178ab145.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-faeff54b296b1c154036fc9f6ca9c13ea6d336f2.061c121dcbd9de9c38b3.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-30b2a91d27f48fa9c977462bb1d69791a88a1110.82bd55b8644197585b26.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-7df56d9846d5f71fc0428c60463f36496d768b20.21939b18a1f7baf9beb3.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-d0bb0dc86392a7e972798467f9dd20ba179b044b.2ac63a1e8c022e84cfc9.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-ff6488b53b31e2f26005da423c1542f5a34ce2b9.49fc3bfb5bbe2c16c705.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-299e64daabd85e596c68c7164ca822525e0cb130.694111ee1cefdcb2670f.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-a3708c7e8c84cce0a3b8da43db0c3cd735be2320.e5a8d7d1710c1d17dd5e.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/shared-c28a9bf3464dd32af4306520d44ac7bcef62e866.9d4098a2070ee9fd2eea.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/chunks/main-question-routes.2e78baecfce3fdb95488.js"></script><script defer="" src="https://static.zhihu.com/event/wza/4613/aria.js?appid=a3637ace5dc3a347f6863b0bac487599" id="ariascripts" wapForceOldFixed="false" loadData="false"></script></body><script src="https://hm.baidu.com/hm.js?98beee57fd2ef70ccdd5ca52b9740c49" async=""></script></html>